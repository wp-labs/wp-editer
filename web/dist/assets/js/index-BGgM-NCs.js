var it=Object.defineProperty,nt=Object.defineProperties;var ot=Object.getOwnPropertyDescriptors;var ke=Object.getOwnPropertySymbols;var lt=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable;var we=(e,i,a)=>i in e?it(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,F=(e,i)=>{for(var a in i||(i={}))lt.call(i,a)&&we(e,a,i[a]);if(ke)for(var a of ke(i))ct.call(i,a)&&we(e,a,i[a]);return e},z=(e,i)=>nt(e,ot(i));var S=(e,i,a)=>new Promise((s,n)=>{var c=g=>{try{d(a.next(g))}catch(k){n(k)}},p=g=>{try{d(a.throw(g))}catch(k){n(k)}},d=g=>g.done?s(g.value):Promise.resolve(g.value).then(c,p);d((a=a.apply(e,i)).next())});import{r as x,j as t,F as re,s as P,B as D,b as pt,z as Ae,e as de,c as dt,d as mt,f as Me,g as ut,h as ht,M as Oe,i as xt,C as ft,k as gt}from"./vendor-ui-CIS8YABk.js";import{R as _t,a as ie,B as bt}from"./vendor-router-B4j9nXPM.js";import{V as Y,_ as je,p as yt,o as A,u as M,i as Tt,a as kt}from"./vendor-utils-DvFGPwn8.js";import{E as H,H as wt,s as Ie,t as r,S as Fe,a as K,l as jt,h as vt,b as St,c as ve,d as Nt,e as Ct,k as Et,f as Lt,g as Dt,i as $t,j as Rt,m as Pt,n as At,o as Se,p as Mt,q as Ot}from"./vendor-codemirror-BA30CH_C.js";import{h as ze,p as ne,q as oe}from"./vendor-highlighter-BwB5r-gc.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();const It={baseURL:"/api",timeout:1e4,errorConfig:{},interceptors:{request:{onConfig:e=>(e.headers=e.headers||{},e),onError:e=>(console.error("请求拦截器错误:",e),Y(e))},response:{onConfig:e=>e,onError:e=>Y(e)}}},Ft={instanceName:"Gitlab",baseURL:"https://gitlab.com/api/v4",timeout:1e4,errorConfig:{},interceptors:{request:{onConfig:e=>{var i,a;return(a=(i=e.headers)["PRIVATE-TOKEN"])!=null||(i["PRIVATE-TOKEN"]=void 0),e},onError:e=>Y(e)},response:{onConfig:e=>e,onError:e=>Y(e)}}};function zt(){je(It),je(Ft),yt("Gitlab")}function Ht(e){return S(this,null,function*(){var i,a;try{const s=yield A.post("/debug/decode/base64",e||"",{headers:{"Content-Type":"text/plain;charset=utf-8"},transformRequest:[c=>c]}),n=s&&typeof s=="object"&&"data"in s?s.data:s;if(n&&n.success===!1){const c=((i=n.error)==null?void 0:i.message)||"Base64解码失败，请稍后重试",p=new Error(c);throw p.code=(a=n.error)==null?void 0:a.code,p.responseData=n,p}return n||{}}catch(s){throw s instanceof Error?s:new Error(typeof s=="string"?s:"Base64解码失败，请稍后重试")}})}function Bt(e){return S(this,null,function*(){var i,a;try{const s=yield A.post("/debug/wpl/format",e||"",{headers:{"Content-Type":"text/plain;charset=utf-8"},transformRequest:[c=>c]}),n=s&&typeof s=="object"&&"data"in s?s.data:s;if(n&&n.success===!1){const c=((i=n.error)==null?void 0:i.message)||"格式化 WPL 代码失败，请稍后重试",p=new Error(c);throw p.code=(a=n.error)==null?void 0:a.code,p.responseData=n,p}return typeof n=="string"?{wpl_code:n}:n||{}}catch(s){throw s instanceof Error?s:new Error(typeof s=="string"?s:"格式化WPL代码失败，请稍后重试")}})}function Ut(e){return S(this,null,function*(){var i,a;try{const s=yield A.post("/debug/oml/format",e||"",{headers:{"Content-Type":"text/plain;charset=utf-8"},transformRequest:[c=>c]}),n=s&&typeof s=="object"&&"data"in s?s.data:s;if(n&&n.success===!1){const c=((i=n.error)==null?void 0:i.message)||"格式化 OML 代码失败，请稍后重试",p=new Error(c);throw p.code=(a=n.error)==null?void 0:a.code,p.responseData=n,p}return typeof n=="string"?{oml_code:n}:n||{}}catch(s){throw s instanceof Error?s:new Error(typeof s=="string"?s:"格式化WPL代码失败，请稍后重试")}})}function Wt(){return S(this,null,function*(){var e,i;try{const a=yield A.get("/debug/examples"),s=a&&typeof a=="object"&&"data"in a?a.data:a;if(s&&s.success===!1){const n=((e=s.error)==null?void 0:e.message)||"获取示例失败，请稍后重试",c=new Error(n);throw c.code=(i=s.error)==null?void 0:i.code,c.responseData=s,c}return s||{}}catch(a){throw a instanceof Error?a:new Error(typeof a=="string"?a:"获取示例失败，请稍后重试")}})}const U=(e,i,a)=>{if(e==null)return"";if(typeof e!="object")return String(e);if(Array.isArray(e))return e.map(d=>U(d,i,a)).filter(d=>d!==""&&d!==null&&d!==void 0).join(", ");if(Array.isArray(e.Array)){const p=e.Array.map(d=>{if(d&&typeof d=="object"){if("value"in d)return U(d.value,i,a);if("Array"in d)return U(d,i,a)}return""}).filter(d=>d!==""&&d!==null&&d!==void 0);return p.length>0?`[${p.join(", ")}]`:""}const s=Object.keys(e);if(s.length===0)return"";const n=s[0],c=e[n];if(c==null)return"";if(typeof c=="object"&&i&&a)try{const p=JSON.parse(a);if(p&&p[i]!==void 0)return String(p[i])}catch(p){}return typeof c=="object"?U(c,i,a):String(c)},Gt=(e,i="")=>Array.isArray(e)?e.map((a,s)=>{let n=a.meta;return a.meta&&typeof a.meta=="object"&&(a.meta.array?n=`array:${a.meta.array}`:n=JSON.stringify(a.meta)),z(F({},a),{no:s+1,meta:n,value:U(a==null?void 0:a.value,a==null?void 0:a.name,i)})}):[];function Ne(e){return S(this,null,function*(){var c,p,d,g,k,w,N,h,_;const{logs:i,rules:a,connectionId:s}=e,n=l=>{const m=(l==null?void 0:l.message)||"执行解析失败，请稍后重试",f=new Error(m);return l!=null&&l.code&&(f.code=l.code),l!=null&&l.details&&(f.details=l.details),l!=null&&l.responseData&&(f.responseData=l.responseData),f};try{const l=yield A.post("/debug/parse",{connection_id:s,rules:a,logs:i}),m=l&&typeof l=="object"&&"data"in l?l.data:l;if(m&&m.success===!1)throw n({message:(c=m.error)==null?void 0:c.message,code:(p=m.error)==null?void 0:p.code,details:((d=m.error)==null?void 0:d.details)||m.error,responseData:m});const f=m;let j=[];return Array.isArray(f==null?void 0:f.fields)?j=f.fields:f!=null&&f.fields&&Array.isArray((g=f==null?void 0:f.fields)==null?void 0:g.items)&&(j=f.fields.items),{fields:Gt(j,(f==null?void 0:f.format_json)||""),rawFields:j,formatJson:typeof(f==null?void 0:f.format_json)=="string"?f.format_json:""}}catch(l){const m=((k=l==null?void 0:l.response)==null?void 0:k.data)||(l==null?void 0:l.data);throw m&&m.success===!1?n({message:((w=m.error)==null?void 0:w.message)||(l==null?void 0:l.message),code:(N=m.error)==null?void 0:N.code,details:((h=m.error)==null?void 0:h.details)||m.error,responseData:m}):l instanceof Error?(m&&!l.responseData&&(l.responseData=m),!l.details&&(m!=null&&m.error)&&(l.details=m.error),!l.code&&((_=m==null?void 0:m.error)!=null&&_.code)&&(l.code=m.error.code),l):n({message:typeof l=="string"?l:"执行解析失败，请稍后重试",responseData:m})}})}function Vt(e){return S(this,null,function*(){var c,p,d,g,k,w,N;const{oml:i,connectionId:a,parseResult:s}=e;console.log("convertRecord",{oml:i,connectionId:a,parseResult:s});const n=h=>{const _=(h==null?void 0:h.message)||"执行转换失败，请稍后重试",l=new Error(_);return h!=null&&h.code&&(l.code=h.code),h!=null&&h.responseData&&(l.responseData=h.responseData),l};try{const h=yield A.post("/debug/transform",{connection_id:a,parse_result:s||{},oml:i}),_=h&&typeof h=="object"&&"data"in h?h.data:h;if(_&&_.success===!1)throw n({message:(c=_.error)==null?void 0:c.message,code:(p=_.error)==null?void 0:p.code,responseData:_});const l=_;let m=[];return Array.isArray(l==null?void 0:l.fields)?m=l.fields:l!=null&&l.fields&&Array.isArray((d=l==null?void 0:l.fields)==null?void 0:d.items)&&(m=l.fields.items),{fields:m,rawFields:m,formatJson:typeof(l==null?void 0:l.format_json)=="string"?l==null?void 0:l.format_json:""}}catch(h){const _=((g=h==null?void 0:h.response)==null?void 0:g.data)||(h==null?void 0:h.data);throw _&&_.success===!1?n({message:((k=_.error)==null?void 0:k.message)||(h==null?void 0:h.message),code:(w=_.error)==null?void 0:w.code,responseData:_}):h instanceof Error?(_&&!h.responseData&&(h.responseData=_),!h.code&&((N=_==null?void 0:_.error)!=null&&N.code)&&(h.code=_.error.code),h):n({message:typeof h=="string"?h:"执行转换失败，请稍后重试",responseData:_})}})}var He=e=>{var{theme:i,settings:a={},styles:s=[]}=e,n={".cm-gutters":{}},c={};a.background&&(c.backgroundColor=a.background),a.backgroundImage&&(c.backgroundImage=a.backgroundImage),a.foreground&&(c.color=a.foreground),a.fontSize&&(c.fontSize=a.fontSize),(a.background||a.foreground)&&(n["&"]=c),a.fontFamily&&(n["&.cm-editor .cm-scroller"]={fontFamily:a.fontFamily}),a.gutterBackground&&(n[".cm-gutters"].backgroundColor=a.gutterBackground),a.gutterForeground&&(n[".cm-gutters"].color=a.gutterForeground),a.gutterBorder&&(n[".cm-gutters"].borderRightColor=a.gutterBorder),a.caret&&(n[".cm-content"]={caretColor:a.caret},n[".cm-cursor, .cm-dropCursor"]={borderLeftColor:a.caret});var p={};a.gutterActiveForeground&&(p.color=a.gutterActiveForeground),a.lineHighlight&&(n[".cm-activeLine"]={backgroundColor:a.lineHighlight},p.backgroundColor=a.lineHighlight),n[".cm-activeLineGutter"]=p,a.selection&&(n["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:a.selection+" !important"}),a.selectionMatch&&(n["& .cm-selectionMatch"]={backgroundColor:a.selectionMatch});var d=H.theme(n,{dark:i==="dark"}),g=wt.define(s),k=[d,Ie(g)];return k},Jt={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},qt=[{tag:[r.keyword,r.operatorKeyword,r.modifier,r.color,r.constant(r.name),r.standard(r.name),r.standard(r.tagName),r.special(r.brace),r.atom,r.bool,r.special(r.variableName)],color:"#0000ff"},{tag:[r.moduleKeyword,r.controlKeyword],color:"#af00db"},{tag:[r.name,r.deleted,r.character,r.macroName,r.propertyName,r.variableName,r.labelName,r.definition(r.name)],color:"#0070c1"},{tag:r.heading,fontWeight:"bold",color:"#0070c1"},{tag:[r.typeName,r.className,r.tagName,r.number,r.changed,r.annotation,r.self,r.namespace],color:"#267f99"},{tag:[r.function(r.variableName),r.function(r.propertyName)],color:"#795e26"},{tag:[r.number],color:"#098658"},{tag:[r.operator,r.punctuation,r.separator,r.url,r.escape,r.regexp],color:"#383a42"},{tag:[r.regexp],color:"#af00db"},{tag:[r.special(r.string),r.processingInstruction,r.string,r.inserted],color:"#a31515"},{tag:[r.angleBracket],color:"#383a42"},{tag:r.strong,fontWeight:"bold"},{tag:r.emphasis,fontStyle:"italic"},{tag:r.strikethrough,textDecoration:"line-through"},{tag:[r.meta,r.comment],color:"#008000"},{tag:r.link,color:"#4078f2",textDecoration:"underline"},{tag:r.invalid,color:"#e45649"}];function Kt(e){var{theme:i="light",settings:a={},styles:s=[]}={};return He({theme:i,settings:ze({},Jt,a),styles:[...qt,...s]})}Kt();var Yt={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},Zt=[{tag:[r.keyword,r.operatorKeyword,r.modifier,r.color,r.constant(r.name),r.standard(r.name),r.standard(r.tagName),r.special(r.brace),r.atom,r.bool,r.special(r.variableName)],color:"#569cd6"},{tag:[r.controlKeyword,r.moduleKeyword],color:"#c586c0"},{tag:[r.name,r.deleted,r.character,r.macroName,r.propertyName,r.variableName,r.labelName,r.definition(r.name)],color:"#9cdcfe"},{tag:r.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[r.typeName,r.className,r.tagName,r.number,r.changed,r.annotation,r.self,r.namespace],color:"#4ec9b0"},{tag:[r.function(r.variableName),r.function(r.propertyName)],color:"#dcdcaa"},{tag:[r.number],color:"#b5cea8"},{tag:[r.operator,r.punctuation,r.separator,r.url,r.escape,r.regexp],color:"#d4d4d4"},{tag:[r.regexp],color:"#d16969"},{tag:[r.special(r.string),r.processingInstruction,r.string,r.inserted],color:"#ce9178"},{tag:[r.angleBracket],color:"#808080"},{tag:r.strong,fontWeight:"bold"},{tag:r.emphasis,fontStyle:"italic"},{tag:r.strikethrough,textDecoration:"line-through"},{tag:[r.meta,r.comment],color:"#6a9955"},{tag:r.link,color:"#6a9955",textDecoration:"underline"},{tag:r.invalid,color:"#ff0000"}];function Qt(e){var{theme:i="dark",settings:a={},styles:s=[]}={};return He({theme:i,settings:ze({},Yt,a),styles:[...Zt,...s]})}var Xt=Qt();const ea="_editor_ptf15_1",ta="_code_ptf15_12",Ce={editor:ea,code:ta},aa=H.theme({"&":{height:"100%"},".cm-content":{fontFamily:'"Fira Code", SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',fontSize:"13px",lineHeight:"1.6",padding:"14px 16px"},".cm-scroller":{overflow:"auto"},".cm-gutters":{minWidth:"48px"},".cm-lineNumbers .cm-gutterElement":{padding:"0 12px 0 10px",textAlign:"right"},".cm-tooltip-autocomplete":{backgroundColor:"#0b1224",border:"1px solid rgba(148, 163, 184, 0.2)",boxShadow:"0 12px 24px rgba(15, 23, 42, 0.45)"},".cm-tooltip-autocomplete .cm-completionList":{backgroundColor:"transparent"},".cm-tooltip-autocomplete ul li":{color:"#94a3b8",backgroundColor:"rgba(0, 0, 0, 0.3)"},".cm-tooltip-autocomplete ul li:hover, .cm-tooltip-autocomplete .cm-completionItem:hover":{backgroundColor:"rgba(59, 130, 246, 0.2)"},".cm-tooltip-autocomplete ul li[aria-selected], .cm-tooltip-autocomplete .cm-completionItem[aria-selected]":{backgroundColor:"rgba(59, 130, 246, 0.3) !important",color:"#f8fafc !important"},".cm-tooltip-autocomplete ul li[aria-selected] .cm-completionMatchedText, .cm-tooltip-autocomplete .cm-completionItem[aria-selected] .cm-completionMatchedText":{color:"#80F4FF !important"},".cm-tooltip-autocomplete .cm-completionMatchedText":{color:"#80F4FF"}}),me=[{label:"peek_symbol",kind:"type",description:"预读匹配但不消费输入",example:"peek_symbol(peek_symbol)",insertText:"peek_symbol(${peek_symbol})"},{label:"symbol",kind:"type",description:"精确匹配指定字符串",example:"symbol(symbol)",insertText:"symbol(${symbol})"},{label:"bool",kind:"type",description:"布尔值，匹配 true/false",example:"true",insertText:"bool"},{label:"chars",kind:"type",description:"字符串，支持引号或裸字符串",example:'"hello" / hello',insertText:"chars"},{label:"array",kind:"type",description:"数组类型后面可以接里面字段的类型",example:'["a", "b", "c"]',insertText:"array/chars"},{label:"digit",kind:"type",description:"整数",example:"123 / -456",insertText:"digit"},{label:"float",kind:"type",description:"浮点数",example:"3.14 / -0.5",insertText:"float"},{label:"time",kind:"type",description:"RFC3339/ISO 8601 时间",example:"2026-01-19T12:34:56Z / 2022-03-21T12:34:56+00:00",insertText:"time"},{label:"time_3339",kind:"type",description:"RFC3339/ISO 8601 时间",example:"2026-01-19T12:34:56Z / 2022-03-21T12:34:56+00:00",insertText:"time_3339"},{label:"time_2822",kind:"type",description:"RFC2822 邮件时间格式",example:"Mon, 07 Jul 2025 09:20:32 +0000",insertText:"time_2822"},{label:"time/clf",kind:"type",description:"Common Log Format 时间",example:"[06/Aug/2019:12:12:19 +0800]",insertText:"time/clf"},{label:"time_timestamp",kind:"type",description:"Unix 秒级时间戳",example:"1647849600",insertText:"time_timestamp"},{label:"ip",kind:"type",description:"IPv4/IPv6 地址",example:"192.168.1.100 / ::1",insertText:"ip"},{label:"ip_net",kind:"type",description:"CIDR 网段",example:"192.168.0.0/24",insertText:"ip_net"},{label:"port",kind:"type",description:"端口号（1-65535）",example:"8080",insertText:"port"},{label:"kvarr",kind:"type",description:"键值对 key=value",example:'key="value"',insertText:"kvarr(${chars@name})"},{label:"json",kind:"type",description:"JSON 对象",example:'{"strict":true}',insertText:"json(${chars@field})"},{label:"http/request",kind:"type",description:"HTTP 请求行",example:'"GET /api/users HTTP/1.1"',insertText:"http/request"},{label:"http/status",kind:"type",description:"HTTP 状态码",example:"200",insertText:"http/status"},{label:"http/agent",kind:"type",description:"User-Agent",example:'"Mozilla/5.0"',insertText:"http/agent"},{label:"http/method",kind:"type",description:"HTTP 方法",example:'"POST"',insertText:"http/method"},{label:"hex",kind:"type",description:"十六进制字符串",example:"0x1A2B / 1A2B",insertText:"hex"},{label:"base64",kind:"type",description:"Base64 编码字符串",example:"YmFzZTY0ZGF0YQ==",insertText:"base64"},{label:"sn",kind:"type",description:"字母数字序列号",example:"ABC123XYZ",insertText:"sn"},{label:"_",kind:"type",description:"忽略该字段",example:"忽略该字段",insertText:"_"},{label:"decode/base64",kind:"function",description:"对整行 Base64 解码",example:"aGVsbG8=",insertText:"decode/base64"},{label:"decode/hex",kind:"function",description:"对整行十六进制解码",example:"hello",insertText:"decode/hex"},{label:"unquote/unescape",kind:"function",description:"移除引号并还原转义",example:'"FW\\|action=DROP\\n\\tmsg"',insertText:"unquote/unescape"},{label:"plg_pipe",kind:"function",description:"自定义预处理扩展",example:"|plg_pipe/dayu|",insertText:"plg_pipe/${name}"},{label:"take",kind:"function",description:"选择指定字段为活跃字段",example:"|take(name)|",insertText:"take(${name})"},{label:"last",kind:"function",description:"选择最后一个字段为活跃字段",example:"|last()|",insertText:"last()"},{label:"f_has",kind:"function",description:"检查字段是否存在",example:"|f_has(status)|",insertText:"f_has(${name})"},{label:"f_chars_has",kind:"function",description:"检查字段值等于字符串",example:"|f_chars_has(status, success)|",insertText:"f_chars_has(${name}, ${val})"},{label:"f_chars_not_has",kind:"function",description:"检查字段值不等于字符串",example:"|f_chars_not_has(level, error)|",insertText:"f_chars_not_has(${name}, ${val})"},{label:"f_chars_in",kind:"function",description:"检查字段值在字符串列表",example:"|f_chars_in(method, [GET, POST])|",insertText:"f_chars_in(${name}, [...])"},{label:"f_digit_has",kind:"function",description:"检查字段值等于数字",example:"|f_digit_has(code, 200)|",insertText:"f_digit_has(${name}, ${num})"},{label:"f_digit_in",kind:"function",description:"检查字段值在数字列表",example:"|f_digit_in(status, [200, 201])|",insertText:"f_digit_in(${name}, [...])"},{label:"f_ip_in",kind:"function",description:"检查 IP 在列表",example:"|f_ip_in(client_ip, [127.0.0.1])|",insertText:"f_ip_in(${name}, [...])"},{label:"has",kind:"function",description:"检查活跃字段存在",example:"|take(name)| has()|",insertText:"has()"},{label:"chars_has",kind:"function",description:"检查活跃字段等于字符串",example:"|take(status)| chars_has(success)|",insertText:"chars_has(${val})"},{label:"chars_not_has",kind:"function",description:"检查活跃字段不等于字符串",example:"|take(level)| chars_not_has(error)|",insertText:"chars_not_has(${val})"},{label:"chars_in",kind:"function",description:"检查活跃字段在字符串列表",example:"|take(method)| chars_in([GET, POST])|",insertText:"chars_in([${...}])"},{label:"digit_has",kind:"function",description:"检查活跃字段等于数字",example:"|take(code)| digit_has(200)|",insertText:"digit_has(${num})"},{label:"ip_in",kind:"function",description:"检查活跃 IP 在列表",example:"|take(client_ip)| ip_in([127.0.0.1])|",insertText:"ip_in([${...}])"},{label:"json_unescape",kind:"function",description:"JSON 反转义",example:"|take(message)| json_unescape()|",insertText:"json_unescape()"},{label:"base64_decode",kind:"function",description:"Base64 解码",example:"|take(payload)| base64_decode()|",insertText:"base64_decode()"},{label:"|",kind:"function",description:"自定义预处理扩展",example:"|plg_pipe/dayu|",insertText:"| plg_pipe/${name}"},{label:"|",kind:"function",description:"选择指定字段为活跃字段",example:"|take(name)|",insertText:"| take(${name})"},{label:"|",kind:"function",description:"选择最后一个字段为活跃字段",example:"|last()|",insertText:"| last()"},{label:"|",kind:"function",description:"检查字段是否存在",example:"|f_has(status)|",insertText:"| f_has(${name})"},{label:"|",kind:"function",description:"检查字段值等于字符串",example:"|f_chars_has(status, success)|",insertText:"| f_chars_has(${name}, ${val})"},{label:"|",kind:"function",description:"检查字段值不等于字符串",example:"|f_chars_not_has(level, error)|",insertText:"| f_chars_not_has(${name}, ${val})"},{label:"|",kind:"function",description:"检查字段值在字符串列表",example:"|f_chars_in(method, [GET, POST])|",insertText:"| f_chars_in(${name}, [...])"},{label:"|",kind:"function",description:"检查字段值等于数字",example:"|f_digit_has(code, 200)|",insertText:"| f_digit_has(${name}, ${num})"},{label:"|",kind:"function",description:"检查字段值在数字列表",example:"|f_digit_in(status, [200, 201])|",insertText:"| f_digit_in(${name}, [...])"},{label:"|",kind:"function",description:"检查 IP 在列表",example:"|f_ip_in(client_ip, [127.0.0.1])|",insertText:"| f_ip_in(${name}, [...])"},{label:"|",kind:"function",description:"检查活跃字段存在",example:"|take(name)| has()|",insertText:"| has()"},{label:"|",kind:"function",description:"检查活跃字段等于字符串",example:"|take(status)| chars_has(success)|",insertText:"| chars_has(${val})"},{label:"|",kind:"function",description:"检查活跃字段不等于字符串",example:"|take(level)| chars_not_has(error)|",insertText:"| chars_not_has(${val})"},{label:"|",kind:"function",description:"检查活跃字段在字符串列表",example:"|take(method)| chars_in([GET, POST])|",insertText:"| chars_in([${...}])"},{label:"|",kind:"function",description:"检查活跃字段等于数字",example:"|take(code)| digit_has(200)|",insertText:"| digit_has(${num})"},{label:"|",kind:"function",description:"检查活跃 IP 在列表",example:"|take(client_ip)| ip_in([127.0.0.1])|",insertText:"| ip_in([${...}])"},{label:"|",kind:"function",description:"JSON 反转义",example:"|take(message)| json_unescape()|",insertText:"| json_unescape()"},{label:"|",kind:"function",description:"Base64 解码",example:"|take(payload)| base64_decode()|",insertText:"| base64_decode()"}],sa=[{label:"peek_symbol",kind:"type",description:"Preview match without consuming input",example:"peek_symbol(peek_symbol)",insertText:"peek_symbol(${peek_symbol})"},{label:"symbol",kind:"type",description:"Exact match for specified string",example:"symbol(symbol)",insertText:"symbol(${symbol})"},{label:"bool",kind:"type",description:"Boolean value, matches true/false",example:"true",insertText:"bool"},{label:"chars",kind:"type",description:"String, quoted or bare",example:'"hello" / hello',insertText:"chars"},{label:"array",kind:"type",description:"The array type can be followed by the types of the fields within it.",example:'["a", "b", "c"]',insertText:"array/chars"},{label:"digit",kind:"type",description:"Integer",example:"123 / -456",insertText:"digit"},{label:"float",kind:"type",description:"Float",example:"3.14 / -0.5",insertText:"float"},{label:"time_3339",kind:"type",description:"RFC3339/ISO 8601 time",example:"2026-01-19T12:34:56Z / 2022-03-21T12:34:56+00:00",insertText:"time_3339"},{label:"time_2822",kind:"type",description:"RFC2822 email time format",example:"Mon, 07 Jul 2025 09:20:32 +0000",insertText:"time_2822"},{label:"time/clf",kind:"type",description:"Common Log Format time",example:"[06/Aug/2019:12:12:19 +0800]",insertText:"time/clf"},{label:"time_timestamp",kind:"type",description:"Unix seconds timestamp",example:"1647849600",insertText:"time_timestamp"},{label:"ip",kind:"type",description:"IPv4/IPv6 address",example:"192.168.1.100 / ::1",insertText:"ip"},{label:"ip_net",kind:"type",description:"CIDR network",example:"192.168.0.0/24",insertText:"ip_net"},{label:"port",kind:"type",description:"Port number (1-65535)",example:"8080",insertText:"port"},{label:"kvarr",kind:"type",description:"Key-value pair key=value",example:'key="value"',insertText:"kvarr(${chars@name})"},{label:"json",kind:"type",description:"JSON object",example:'{"strict":true}',insertText:"json(${chars@field})"},{label:"http/request",kind:"type",description:"HTTP request line",example:'"GET /api/users HTTP/1.1"',insertText:"http/request"},{label:"http/status",kind:"type",description:"HTTP status code",example:"200",insertText:"http/status"},{label:"http/agent",kind:"type",description:"User-Agent",example:'"Mozilla/5.0"',insertText:"http/agent"},{label:"http/method",kind:"type",description:"HTTP method",example:'"POST"',insertText:"http/method"},{label:"hex",kind:"type",description:"Hex string",example:"0x1A2B / 1A2B",insertText:"hex"},{label:"base64",kind:"type",description:"Base64 string",example:"YmFzZTY0ZGF0YQ==",insertText:"base64"},{label:"sn",kind:"type",description:"Alphanumeric serial number",example:"ABC123XYZ",insertText:"sn"},{label:"_",kind:"type",description:"Ignore this field",example:"Ignore this field",insertText:"_"},{label:"decode/base64",kind:"function",description:"Base64 decode whole line",example:"aGVsbG8=",insertText:"decode/base64"},{label:"decode/hex",kind:"function",description:"Hex decode whole line",example:"hello",insertText:"decode/hex"},{label:"unquote/unescape",kind:"function",description:"Remove quotes and unescape",example:'"FW\\|action=DROP\\n\\tmsg"',insertText:"unquote/unescape"},{label:"plg_pipe",kind:"function",description:"Custom preprocessor extension",example:"|plg_pipe/dayu|",insertText:"plg_pipe/${name}"},{label:"take",kind:"function",description:"Select specified field as active",example:"|take(name)|",insertText:"take(${name})"},{label:"last",kind:"function",description:"Select last field as active",example:"|last()|",insertText:"last()"},{label:"f_has",kind:"function",description:"Check field exists",example:"|f_has(status)|",insertText:"f_has(${name})"},{label:"f_chars_has",kind:"function",description:"Check field equals string",example:"|f_chars_has(status, success)|",insertText:"f_chars_has(${name}, ${val})"},{label:"f_chars_not_has",kind:"function",description:"Check field not equal string",example:"|f_chars_not_has(level, error)|",insertText:"f_chars_not_has(${name}, ${val})"},{label:"f_chars_in",kind:"function",description:"Check field in string list",example:"|f_chars_in(method, [GET, POST])|",insertText:"f_chars_in(${name}, [...])"},{label:"f_digit_has",kind:"function",description:"Check field equals number",example:"|f_digit_has(code, 200)|",insertText:"f_digit_has(${name}, ${num})"},{label:"f_digit_in",kind:"function",description:"Check field in number list",example:"|f_digit_in(status, [200, 201])|",insertText:"f_digit_in(${name}, [...])"},{label:"f_ip_in",kind:"function",description:"Check IP in list",example:"|f_ip_in(client_ip, [127.0.0.1])|",insertText:"f_ip_in(${name}, [...])"},{label:"has",kind:"function",description:"Check active field exists",example:"|take(name)| has()|",insertText:"has()"},{label:"chars_has",kind:"function",description:"Check active field equals string",example:"|take(status)| chars_has(success)|",insertText:"chars_has(${val})"},{label:"chars_not_has",kind:"function",description:"Check active field not equal string",example:"|take(level)| chars_not_has(error)|",insertText:"chars_not_has(${val})"},{label:"chars_in",kind:"function",description:"Check active field in string list",example:"|take(method)| chars_in([GET, POST])|",insertText:"chars_in([${...}])"},{label:"digit_has",kind:"function",description:"Check active field equals number",example:"|take(code)| digit_has(200)|",insertText:"digit_has(${num})"},{label:"ip_in",kind:"function",description:"Check active IP in list",example:"|take(client_ip)| ip_in([127.0.0.1])|",insertText:"ip_in([${...}])"},{label:"json_unescape",kind:"function",description:"JSON unescape",example:"|take(message)| json_unescape()|",insertText:"json_unescape()"},{label:"base64_decode",kind:"function",description:"Base64 decode",example:"|take(payload)| base64_decode()|",insertText:"base64_decode()"}],Ee={"zh-CN":{description:"说明",example:"示例",packageDetail:"包定义",packageInfo:"定义 WPL 包路径与作用域。",ruleDetail:"规则定义",ruleInfo:"定义规则名称与规则体。"},"en-US":{description:"Description",example:"Example",packageDetail:"Package",packageInfo:"Define WPL package path and scope.",ruleDetail:"Rule",ruleInfo:"Define rule name and body."}},Be=e=>Ee[e]||Ee["zh-CN"],Ue=(e,i,a)=>{const s=[];return i&&s.push(`${e.description}：${i}`),a&&s.push(`${e.example}：${a}`),s.length?s.join(`
`):void 0},ra={wpl:{keywords:["package","rule","plg_pipe","alt","opt","some_of","seq","order","tag","copy_raw","include","macro"],constants:[]}},We=ra.wpl,ia=new Set(We.keywords),na=new Set(me.filter(e=>e.kind==="type").map(e=>e.label)),oa=new Set(me.filter(e=>e.kind==="function").map(e=>e.label)),la=new Set(We.constants),ca=/[\w/]+|\|/,pa=e=>{const i=Be(e),a=e==="en-US"?sa:me;return[K(["package /${path}/ {","}"].join(`
`),{label:"package",type:"keyword",detail:i.packageDetail,info:i.packageInfo}),K(["rule ${name} {(",")}"].join(`
`),{label:"rule",type:"keyword",detail:i.ruleDetail,info:i.ruleInfo}),...a.map(s=>{const n=s.description;return K(s.insertText,{label:s.label,type:s.kind,detail:n,info:Ue(i,n,s.example)})})]},da=Fe.define({token(e){if(e.eatSpace())return null;if(e.peek()==='"'){for(e.next();!e.eol()&&!(e.next()==='"'&&!e.match(/\\$/,!1)););return"string"}if(e.match(/-?\d+(\.\d+)?/))return"number";if(e.match(/[\w/]+/)){const a=e.current();return a==="array"||a.startsWith("array/")?"typeName":ia.has(a)?"keyword":na.has(a)?"typeName":oa.has(a)||a.startsWith("plg_pipe/")?"variableName.function":la.has(a)?"atom":"variableName"}return e.match(/[{}()[\],|:]/)?"operator":(e.next(),null)}}),ma=[{label:"chars()",description:"直接创建常量值",example:"chars(13)",insertText:"chars(${chars})"},{label:"digit()",description:"直接创建常量值",example:"digit(13)",insertText:"digit(${digit})"},{label:"read",description:"简单取值",example:"read(simple_chars)",insertText:"read(${Variable})"},{label:"read(keys)",description:"通配符批量操作",example:"a_name_fields = read(keys:[A*/name])",insertText:"a_name_fields = read(${keys:[A*/name]})"},{label:"read",description:"字段不存在时使用默认值",example:"read(optional_field) { _ : chars(DEFAULT_VALUE) }",insertText:"read(${field}) { _ : chars(DEFAULT) }"},{label:"option:[]",description:"选择取值（按顺序尝试多个字段）",example:"read(option:[select_one, select_two])",insertText:"option:[${select_one}]"},{label:"take",description:"破坏性读取并移除源字段",example:"field_taken = take(source_field)",insertText:"take(${source_field})"},{label:"take",description:"take失败使用默认值",example:"field_taken_again = take(source_field) { _ : chars(already_taken) }",insertText:"take(${source_field}) { _ : chars(DEFAULT) }"},{label:"take()",description:"取所有字段",example:"all_fields = take()",insertText:"all_fields = take()"},{label:"take(keys)",description:"通配符批量操作",example:"path_fields = take(keys:[*/path])",insertText:"path_fields = take(keys:[*/path])"},{label:"Now::time()",description:"获取当前完整时间",example:"current_time = Now::time()",insertText:"current_time = Now::time()"},{label:"Now::date()",description:"获取当前日期",example:"current_date = Now::date()",insertText:"Now::date()"},{label:"Now::hour()",description:"获取当前小时",example:"current_hour = Now::hour()",insertText:"Now::hour()"},{label:"match",description:"范围判断",example:"num_range = match read(option:[num_range]) { in (digit(0), digit(1000)) => read(num_range) }",insertText:"match read(option:[${num_range}]) { in (digit(0), digit(1000)) => read(num_range) }"},{label:"match",description:"字段匹配",example:"is_enabled : digit = match read(field) { bool(true) => digit(1) }",insertText:`match read(\${field}) {
  _ => chars(defaule) 
}`},{label:"match",description:"双字段组合匹配",example:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }",insertText:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }"},{label:"match + !",description:"否定条件匹配",example:"valid_status = match read(status) { !chars(error) => chars(ok) }",insertText:"match read(status) { !chars(!{error}) => chars(ok) }"},{label:"Time::to_ts_zone",description:"时间转换（时区）",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"Time::to_ts_zone(${0}, ms)"},{label:"Time::to_ts",description:"时间转换（秒级）",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"Time::to_ts"},{label:"Time::to_ts_ms",description:"时间转换（毫秒）",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"Time::to_ts_ms"},{label:"Time::to_ts_us",description:"时间转换（微秒）",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"Time::to_ts_us"},{label:"base64_decode",description:"Base64 解码",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"base64_decode(${Utf8})"},{label:"base64_encode",description:"Base64 编码",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"base64_encode"},{label:"html_escape",description:"HTML 转义",example:"html_escaped = pipe read(html) | html_escape",insertText:"html_escape"},{label:"html_unescape",description:"HTML 反转义",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"html_unescape"},{label:"json_escape",description:"JSON 转义",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"json_escape"},{label:"json_unescape",description:"JSON 反转义",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"json_unescape"},{label:"str_escape",description:"字符串转义",example:"str_escaped = pipe read(str) | str_escape",insertText:"str_escape"},{label:"to_str",description:"转为字符串",example:"to_str_result = pipe read(str) | to_str",insertText:"to_str"},{label:"to_json",description:"转为 JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"to_json"},{label:"ip4_to_int",description:"IPv4 转整数",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"ip4_to_int"},{label:"nth",description:"数组取元素",example:"array_first = pipe read(array_str) | nth(0)",insertText:"nth(${0})"},{label:"get",description:"对象嵌套取值",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"get(${one/two})"},{label:"path(name)",description:"提取文件名",example:"file_name = pipe read(path) | path(name)",insertText:"path(name)"},{label:"path(path)",description:"提取文件路径",example:"file_path = pipe read(path) | path(path)",insertText:"path(path)"},{label:"url(domain)",description:"提取 URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"url(domain)"},{label:"url(host)",description:"提取 URL host",example:"url_host = pipe read(url) | url(host)",insertText:"url(host)"},{label:"url(uri)",description:"提取 URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"url(uri)"},{label:"url(path)",description:"提取 URL path",example:"url_path = pipe read(url) | url(path)",insertText:"url(path)"},{label:"url(params)",description:"提取 URL params",example:"url_params = pipe read(url) | url(params)",insertText:"url(params)"},{label:"skip_empty",description:"跳过空值",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"skip_empty"},{label:"pipe",description:"流处理",example:"pipe simple_transform = read(data) | to_json",insertText:"pipe"},{label:"fmt",description:"字符串格式化",example:'splice = fmt("{one}:{two}|{three}:{four}", read(one), read(two), read(three), read(four))',insertText:"fmt"},{label:"object",description:"对象创建",example:"extends = object { extend1, extend2 = read() }",insertText:"object { }"},{label:"collect",description:"数组收集",example:"collected_ports : array = collect read(keys:[sport, dport, extra_port])",insertText:"collect read(keys:[${sport}])"},{label:"collect + 通配符",description:"通配符收集",example:"wildcard_items : array = collect take(keys:[details[*]/process_name])",insertText:"collect take(keys:[${details[*]/process_name}])"},{label:"|",description:"时间转换（时区）",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"| Time::to_ts_zone(${0}, ms)"},{label:"|",description:"时间转换（秒级）",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"| Time::to_ts"},{label:"|",description:"时间转换（毫秒）",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"| Time::to_ts_ms"},{label:"|",description:"时间转换（微秒）",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"| Time::to_ts_us"},{label:"|",description:"Base64 解码",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"| base64_decode(${Utf8})"},{label:"|",description:"Base64 编码",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"| base64_encode"},{label:"|",description:"HTML 转义",example:"html_escaped = pipe read(html) | html_escape",insertText:"| html_escape"},{label:"|",description:"HTML 反转义",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"| html_unescape"},{label:"|",description:"JSON 转义",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"| json_escape"},{label:"|",description:"JSON 反转义",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"| json_unescape"},{label:"|",description:"字符串转义",example:"str_escaped = pipe read(str) | str_escape",insertText:"| str_escape"},{label:"|",description:"转为字符串",example:"to_str_result = pipe read(str) | to_str",insertText:"| to_str"},{label:"|",description:"转为 JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"| to_json"},{label:"|",description:"IPv4 转整数",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"| ip4_to_int"},{label:"|",description:"数组取元素",example:"array_first = pipe read(array_str) | nth(0)",insertText:"| nth(${0})"},{label:"|",description:"对象嵌套取值",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"| get(${one/two})"},{label:"|",description:"提取文件名",example:"file_name = pipe read(path) | path(name)",insertText:"| path(name)"},{label:"|",description:"提取文件路径",example:"file_path = pipe read(path) | path(path)",insertText:"| path(path)"},{label:"|",description:"提取 URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"| url(domain)"},{label:"|",description:"提取 URL host",example:"url_host = pipe read(url) | url(host)",insertText:"| url(host)"},{label:"|",description:"提取 URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"| url(uri)"},{label:"|",description:"提取 URL path",example:"url_path = pipe read(url) | url(path)",insertText:"| url(path)"},{label:"|",description:"提取 URL params",example:"url_params = pipe read(url) | url(params)",insertText:"| url(params)"},{label:"|",description:"跳过空值",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"| skip_empty"},{label:"|",description:"流处理",example:"pipe simple_transform = read(data) | to_json",insertText:"| pipe"}],ua=[{label:"chars()",description:"Create constant value",example:"chars(13)",insertText:"chars(${chars})"},{label:"digit()",description:"Create constant value",example:"digit(13)",insertText:"digit(${digit})"},{label:"read",description:"Simple read",example:"read(simple_chars)",insertText:"read(${Variable})"},{label:"read(keys)",description:"Wildcard batch operation",example:"a_name_fields = read(keys:[A*/name])",insertText:"read(${keys:[A*/name]})"},{label:"read",description:"Use default when field missing",example:"read(optional_field) { _ : chars(DEFAULT_VALUE) }",insertText:"read(${field}) { _ : chars(DEFAULT) }"},{label:"option:[]",description:"Select values in order",example:"read(option:[select_one, select_two])",insertText:"option:[${select_one}]"},{label:"take",description:"Destructive read and remove source field",example:"field_taken = take(source_field)",insertText:"take(${source_field})"},{label:"take",description:"Use default when take fails",example:"field_taken_again = take(source_field) { _ : chars(already_taken) }",insertText:"take(${source_field}) { _ : chars(DEFAULT) }"},{label:"take()",description:"Take all fields",example:"all_fields = take()",insertText:"all_fields = take()"},{label:"take(keys)",description:"Wildcard batch operation",example:"path_fields = take(keys:[*/path])",insertText:"path_fields = take(keys:[*/path])"},{label:"Now::time()",description:"Get current full time",example:"current_time = Now::time()",insertText:"current_time = Now::time()"},{label:"Now::date()",description:"Get current date",example:"current_date = Now::date()",insertText:"Now::date()"},{label:"Now::hour()",description:"Get current hour",example:"current_hour = Now::hour()",insertText:"Now::hour()"},{label:"match",description:"Range match",example:"num_range = match read(option:[num_range]) { in (digit(0), digit(1000)) => read(num_range) }",insertText:"match read(option:[${num_range}]) { in (digit(0), digit(1000)) => read(num_range) }"},{label:"match",description:"Field match",example:"is_enabled : digit = match read(enabled) { bool(true) => digit(1) }",insertText:`match read(\${field}) {
  _ => chars(default)
}`},{label:"match",description:"Two-field tuple match",example:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }",insertText:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }"},{label:"match + !",description:"Negation match",example:"valid_status = match read(status) { !chars(error) => chars(ok) }",insertText:"match read(status) { !chars(!{error}) => chars(ok) }"},{label:"Time::to_ts_zone",description:"Time conversion (timezone)",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"Time::to_ts_zone(${0}, ms)"},{label:"Time::to_ts",description:"Time conversion (seconds)",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"Time::to_ts"},{label:"Time::to_ts_ms",description:"Time conversion (milliseconds)",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"Time::to_ts_ms"},{label:"Time::to_ts_us",description:"Time conversion (microseconds)",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"Time::to_ts_us"},{label:"base64_decode",description:"Base64 decode",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"base64_decode(${Utf8})"},{label:"base64_encode",description:"Base64 encode",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"base64_encode"},{label:"html_escape",description:"HTML escape",example:"html_escaped = pipe read(html) | html_escape",insertText:"html_escape"},{label:"html_unescape",description:"HTML unescape",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"html_unescape"},{label:"json_escape",description:"JSON escape",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"json_escape"},{label:"json_unescape",description:"JSON unescape",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"json_unescape"},{label:"str_escape",description:"String escape",example:"str_escaped = pipe read(str) | str_escape",insertText:"str_escape"},{label:"to_str",description:"Convert to string",example:"to_str_result = pipe read(str) | to_str",insertText:"to_str"},{label:"to_json",description:"Convert to JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"to_json"},{label:"ip4_to_int",description:"IPv4 to integer",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"ip4_to_int"},{label:"nth",description:"Get array element",example:"array_first = pipe read(array_str) | nth(0)",insertText:"nth(${0})"},{label:"get",description:"Get nested object value",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"get(${one/two})"},{label:"path(name)",description:"Extract filename",example:"file_name = pipe read(path) | path(name)",insertText:"path(name)"},{label:"path(path)",description:"Extract file path",example:"file_path = pipe read(path) | path(path)",insertText:"path(path)"},{label:"url(domain)",description:"Extract URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"url(domain)"},{label:"url(host)",description:"Extract URL host",example:"url_host = pipe read(url) | url(host)",insertText:"url(host)"},{label:"url(uri)",description:"Extract URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"url(uri)"},{label:"url(path)",description:"Extract URL path",example:"url_path = pipe read(url) | url(path)",insertText:"url(path)"},{label:"url(params)",description:"Extract URL params",example:"url_params = pipe read(url) | url(params)",insertText:"url(params)"},{label:"skip_empty",description:"Skip empty values",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"skip_empty"},{label:"pipe",description:"Stream processing",example:"pipe simple_transform = read(data) | to_json",insertText:"pipe"},{label:"fmt",description:"String format",example:'splice = fmt("{one}:{two}|{three}:{four}", read(one), read(two), read(three), read(four))',insertText:"fmt"},{label:"object",description:"Create object",example:"extends = object { extend1, extend2 = read() }",insertText:"object { }"},{label:"collect",description:"Collect array",example:"collected_ports : array = collect read(keys:[sport, dport, extra_port])",insertText:"collect read(keys:[${sport}])"},{label:"collect + 通配符",description:"Collect with wildcard",example:"wildcard_items : array = collect take(keys:[details[*]/process_name])",insertText:"collect take(keys:[${details[*]/process_name}])"},{label:"|",description:"Time conversion (timezone)",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"| Time::to_ts_zone(${0}, ms)"},{label:"|",description:"Time conversion (seconds)",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"| Time::to_ts"},{label:"|",description:"Time conversion (milliseconds)",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"| Time::to_ts_ms"},{label:"|",description:"Time conversion (microseconds)",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"| Time::to_ts_us"},{label:"|",description:"Base64 decode",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"| base64_decode(${Utf8})"},{label:"|",description:"Base64 encode",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"| base64_encode"},{label:"|",description:"HTML escape",example:"html_escaped = pipe read(html) | html_escape",insertText:"| html_escape"},{label:"|",description:"HTML unescape",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"| html_unescape"},{label:"|",description:"JSON escape",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"| json_escape"},{label:"|",description:"JSON unescape",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"| json_unescape"},{label:"|",description:"String escape",example:"str_escaped = pipe read(str) | str_escape",insertText:"| str_escape"},{label:"|",description:"Convert to string",example:"to_str_result = pipe read(str) | to_str",insertText:"| to_str"},{label:"|",description:"Convert to JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"| to_json"},{label:"|",description:"IPv4 to integer",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"| ip4_to_int"},{label:"|",description:"Get array element",example:"array_first = pipe read(array_str) | nth(0)",insertText:"| nth(${0})"},{label:"|",description:"Get nested object value",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"| get(${one/two})"},{label:"|",description:"Extract filename",example:"file_name = pipe read(path) | path(name)",insertText:"| path(name)"},{label:"|",description:"Extract file path",example:"file_path = pipe read(path) | path(path)",insertText:"| path(path)"},{label:"|",description:"Extract URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"| url(domain)"},{label:"|",description:"Extract URL host",example:"url_host = pipe read(url) | url(host)",insertText:"| url(host)"},{label:"|",description:"Extract URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"| url(uri)"},{label:"|",description:"Extract URL path",example:"url_path = pipe read(url) | url(path)",insertText:"| url(path)"},{label:"|",description:"Extract URL params",example:"url_params = pipe read(url) | url(params)",insertText:"| url(params)"},{label:"|",description:"Skip empty values",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"| skip_empty"},{label:"|",description:"Stream processing",example:"pipe simple_transform = read(data) | to_json",insertText:"| pipe"}],ha={oml:{keywords:["match","object","pipe","option","collect","fmt","select","from","where","in","keys","get","and","or","not","name","rule"],types:["auto","chars","digit","float","ip","time","bool","obj","array"],functions:["read","take","Now::time","Now::date","Now::hour","Time::to_ts_zone","Time::to_ts","Time::to_ts_ms","Time::to_ts_us","base64_decode","base64_encode","html_escape","html_unescape","json_escape","json_unescape","str_escape","to_str","to_json","ip4_to_int","ip4_int","nth","get","path","url","sxf_get","skip_empty"],privacyTypes:["privacy_ip","privacy_specify_ip","privacy_id_card","privacy_mobile","privacy_mail","privacy_domain","privacy_specify_name","privacy_specify_domain","privacy_specify_address","privacy_specify_company","privacy_keymsg"],constants:["true","false"]}},W=ha.oml,Le=new Set(W.keywords),le=new Set(W.types),De=new Set(W.functions),$e=new Set(W.privacyTypes),xa=new Set(W.constants),fa=/[\w/:\[\]]+|\|/,ga=e=>{const i=Be(e);return(e==="en-US"?ua:ma).map(s=>{const n=s.description;return K(s.insertText,{label:s.label,type:"function",detail:n,info:Ue(i,n,s.example)})})},_a=Fe.define({startState(){return{inHeader:!1,inPrivacy:!1,afterColon:!1,afterEqual:!1,expectType:!1,parenDepth:0}},token(e,i){if(e.eatSpace())return null;const a=e.peek();if(a==="#"||a==="/"&&e.match("//",!1))return e.skipToEnd(),"comment";if(e.match(/^---/))return i.inHeader?i.inPrivacy||(i.inPrivacy=!0):i.inHeader=!0,"keyword";if(a==='"'||a==="'"){const s=a;for(e.next();!e.eol();){const n=e.next();if(n===s)break;n==="\\"&&e.next()}return"string"}if(e.match(/^-?\d+(\.\d+){0,3}/))return"number";if(a==="@")return e.next(),e.match(/\w+/)?"variableName":"operator";if(a==="/"&&e.match(/^\/[\w/\[\]]+/))return"string";if(e.match(/^[{}()[\],|;=!:]/)){const s=e.current();return s==="("&&i.parenDepth++,s===")"&&i.parenDepth--,s===":"&&(i.afterColon=!0),s==="="&&(i.afterEqual=!0),s===";"&&(i.afterEqual=!1,i.afterColon=!1,i.expectType=!1),"operator"}if(e.match(/^[\w:]+/)){const s=e.current(),n=s.replace(/:+$/,""),c=e.pos;let p=!1;for(;e.peek()===" "||e.peek()==="	";)e.next();return e.peek()==="("&&(p=!0),e.pos=c,i.inPrivacy&&i.afterColon&&$e.has(s)?(i.afterColon=!1,"typeName"):i.afterColon&&!i.afterEqual&&le.has(s)?(i.expectType=!1,i.afterColon=!1,"typeName"):xa.has(s)?"atom":Le.has(s)||Le.has(n)?"keyword":le.has(s)||le.has(n)?"typeName":s.includes("::")||De.has(s)||De.has(n)||p?"variableName.function":$e.has(s)?"typeName":"variableName"}return e.next(),null}}),Re=(e,i)=>a=>{var p,d;const s=a.matchBefore(i),n=a.matchBefore(/\|/);return!s&&!n&&!a.explicit?null:{from:(d=(p=n||s)==null?void 0:p.from)!=null?d:a.pos,options:e,validFor:i}};function ba(e,i){const a=x.useRef(null),s=x.useRef(null),n=e.language||"plain",c=e.textColor,p=e.theme,{i18n:d}=M(),g=d.language,k=x.useMemo(()=>pa(g),[g]),w=x.useMemo(()=>ga(g),[g]),N=x.useMemo(()=>Re(k,ca),[k]),h=x.useMemo(()=>Re(w,fa),[w]),_=x.useMemo(()=>c?H.theme({"&":{color:c},".cm-content":{color:c}}):null,[c]);return x.useImperativeHandle(i,()=>({getValue:()=>{var l;return((l=s.current)==null?void 0:l.state.doc.toString())||""},setValue:l=>{const m=s.current;if(!m)return;const f=l||"",j=m.state.doc.toString();j!==f&&m.dispatch({changes:{from:0,to:j.length,insert:f}})}})),x.useEffect(()=>{if(!a.current)return;const l=H.updateListener.of($=>{var C;$.docChanged&&((C=e.onChange)==null||C.call(e,$.state.doc.toString()))}),m=[jt(),vt(),St(),H.lineWrapping,ve.tabSize.of(2),Nt(),Ct(),Et.of([...Lt,...Dt,$t,...Rt,...Pt]),aa,Ie(At,{fallback:!0}),..._?[_]:[],l];p==="vscodeDark"||!p?m.push(Xt):m.push(Ot),n==="wpl"&&m.splice(6,0,da,Se({override:[N]})),n==="oml"&&m.splice(6,0,_a,Se({override:[h]})),n==="json"&&m.splice(6,0,Mt());const f=ve.create({doc:e.value||"",extensions:m}),j=new H({state:f,parent:a.current});return s.current=j,()=>{j.destroy(),s.current=null}},[n,g,N,h,_,p]),x.useEffect(()=>{const l=s.current;if(!l||e.value===void 0)return;const m=e.value||"",f=l.state.doc.toString();f!==m&&l.dispatch({changes:{from:0,to:f.length,insert:m}})},[e.value]),t.jsx("div",{className:`${Ce.editor} ${e.className||""}`,children:t.jsx("div",{ref:a,className:Ce.code})})}const ce=x.forwardRef(ba),ya=[{name:"nginx",wpl_code:`package /nginx/ {
    rule nginx {
        (
            ip:sip,2*_,chars:timestamp<[,]>,http/request",chars:status,chars:size,chars:referer",http/agent",_"
        )
    }
}
`,oml_code:"",sample_data:'180.57.30.148 - - [21/Jan/2025:01:40:02 +0800] "GET /nginx-logo.png HTTP/1.1" 500 368 "<http://207.131.38.110/>" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36" "-"'}];function pe(){const{t:e}=M(),[i,a]=x.useState("parse"),[s,n]=x.useState(""),[c,p]=x.useState(""),[d,g]=x.useState(null),[k,w]=x.useState(!1),[N,h]=x.useState("table"),[_,l]=x.useState(!0),[m,f]=x.useState(null),[j,$]=x.useState(""),[C,Z]=x.useState(null),[O,Q]=x.useState(null),[G,ue]=x.useState("table"),[V,he]=x.useState("table"),[J,Ve]=x.useState(!0),[X,Je]=x.useState(!0),[R,q]=x.useState(null),[ee,qe]=x.useState(ya),[Ke,xe]=x.useState(null),[fe,ge]=x.useState(!1),[_e,Ye]=x.useState(!1),be=x.useRef(!1),te=(o,u,y)=>{if(o)try{const b=JSON.parse(o),T=y?y(b):b;return JSON.stringify(T,null,2)}catch(b){return o}return JSON.stringify(u,null,2)},Ze=()=>S(this,null,function*(){w(!0),f(null);try{const o=yield Ne({logs:s,rules:c});g(o),o!=null&&o.fields&&(o!=null&&o.rawFields)&&(console.log("转换页解析结果:",o.rawFields),Z({fields:o.rawFields,formatJson:o.formatJson}))}catch(o){f(o)}finally{w(!1)}}),Qe=()=>S(this,null,function*(){if(!(fe||_e||be.current)){be.current=!0,ge(!0);try{const o=yield Wt(),u=o&&typeof o=="object"?Object.values(o):[];Array.isArray(u)&&u.length>0?(qe(u),Ye(!0)):!_e&&(!u||u.length===0)&&P.info(e("simulateDebug.examples.noAvailable"))}catch(o){P.error(`${e("simulateDebug.examples.fetchError")}：${(o==null?void 0:o.message)||o}`)}finally{ge(!1)}}}),Xe=()=>S(this,null,function*(){try{const o=yield Bt(c);console.log("格式化WPL代码响应:",o),p((o==null?void 0:o.wpl_code)||"")}catch(o){P.error(`${e("simulateDebug.parseRule.formatError")}：${(o==null?void 0:o.message)||o}`)}});x.useEffect(()=>{Qe()},[]);const et=o=>S(this,null,function*(){if(!o)return;const{sample_data:u,wpl_code:y,oml_code:b}=o;if(n(u||""),p(y||""),$(b||""),xe(o.name),!(!u||!y)){w(!0),f(null);try{const T=yield Ne({logs:u,rules:y});g(T),T!=null&&T.fields&&(T!=null&&T.rawFields)&&Z({fields:T.rawFields,formatJson:T.formatJson})}catch(T){f(T)}finally{w(!1)}}}),tt=()=>{n(""),p(""),g(null),f(null),$(""),Z(null),Q(null),q(null),xe(null)},at=()=>S(this,null,function*(){try{const o=yield Ht(s);console.log("Base64解码响应:",o),n(o||"")}catch(o){P.error(`${e("simulateDebug.logData.base64Error")}：${(o==null?void 0:o.message)||o}`)}}),st=()=>S(this,null,function*(){var o;if(!j){P.warning(e("simulateDebug.omlInput.fillOmlWarning"));return}w(!0),q(null);try{console.log("转换页解析结果:",C);const u=yield Vt({oml:j,parseResult:C});let y=[];Array.isArray(u==null?void 0:u.fields)?y=u.fields:u!=null&&u.fields&&Array.isArray((o=u==null?void 0:u.fields)==null?void 0:o.items)&&(y=u.fields.items);const b=se(y,u.formatJson||"");Q({fields:b,formatJson:u.formatJson||"",rawFields:y}),q(null)}catch(u){P.error(`${e("simulateDebug.convertResult.convertError")}：${(u==null?void 0:u.message)||u}`),q(u),Q(null)}finally{w(!1)}}),rt=()=>S(this,null,function*(){try{const o=yield Ut(j);$((o==null?void 0:o.oml_code)||"")}catch(o){P.error(`${e("simulateDebug.omlInput.formatError")}：${(o==null?void 0:o.message)||o}`)}});e("simulateDebug.tabs.parse"),e("simulateDebug.tabs.convert");const ae=[{title:e("simulateDebug.table.no"),dataIndex:"no",key:"no",width:60},{title:e("simulateDebug.table.meta"),dataIndex:"meta",key:"meta",width:120},{title:e("simulateDebug.table.name"),dataIndex:"name",key:"name",width:150},{title:e("simulateDebug.table.value"),dataIndex:"value",key:"value",style:{wordWrap:"break-word",wordBreak:"break-all",maxWidth:300}}],I=(o,u)=>{const y=Array.isArray(o)?o:[];return u?y:y.filter(b=>{if(!b||typeof b!="object")return!1;const T=b.value;return T!==""&&T!==null&&T!==void 0})},B=(o,u,y)=>{if(o==null)return"";if(typeof o!="object")return String(o);if(Array.isArray(o)){const L=o.map(v=>B(v,u,y)).filter(v=>v!==""&&v!==null&&v!==void 0);return L.length>0?`[${L.join(", ")}]`:""}if(Array.isArray(o.Array)){const L=o.Array.map(v=>v&&typeof v=="object"&&"value"in v?B(v.value,u,y):B(v,u,y)).filter(v=>v!==""&&v!==null&&v!==void 0);return L.length>0?`[${L.join(", ")}]`:""}const b=Object.keys(o);if(b.length===0)return"";const T=b[0],E=o[T];if(E==null)return"";if(typeof E=="object"&&u&&y)try{const L=JSON.parse(y);if(L&&L[u]!==void 0)return String(L[u])}catch(L){}return typeof E=="object"?B(E,u,y):String(E)},se=(o,u)=>(Array.isArray(o)?o:[]).map((b,T)=>{let E=b.meta;return b.meta&&typeof b.meta=="object"&&(b.meta.array?E=`array:${b.meta.array}`:E=JSON.stringify(b.meta)),z(F({},b),{no:T+1,meta:E,value:B(b==null?void 0:b.value,b==null?void 0:b.name,u)})}),ye=()=>m?t.jsxs("div",{style:{padding:"20px",backgroundColor:"#fff1f0",border:"1px solid #ffccc7",borderRadius:4,margin:"10px"},children:[t.jsx("h4",{style:{color:"#f5222d",marginBottom:"8px",fontWeight:"bold"},children:e("simulateDebug.parseResult.parseFailed")}),t.jsx("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",color:"#666",margin:"0 0 8px 0",fontSize:"14px",lineHeight:"1.5"},children:m.message||e("simulateDebug.parseResult.parseError")}),m.code&&t.jsxs("p",{style:{color:"#f5222d",margin:"8px 0 0 0"},children:[t.jsxs("span",{style:{fontWeight:"bold"},children:[e("simulateDebug.parseResult.errorCode"),"："]}),m.code]})]}):null,Te=()=>{var u,y,b,T;if(!R)return null;const o=R.message||((y=(u=R.responseData)==null?void 0:u.error)==null?void 0:y.message)||((T=(b=R.data)==null?void 0:b.error)==null?void 0:T.message)||e("simulateDebug.convertResult.convertError");return t.jsxs("div",{style:{padding:"20px",backgroundColor:"#fff1f0",border:"1px solid #ffccc7",borderRadius:4,margin:"10px"},children:[t.jsx("h4",{style:{color:"#f5222d",marginBottom:"8px",fontWeight:"bold"},children:e("simulateDebug.convertResult.convertFailed")}),t.jsx("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",color:"#666",margin:"0 0 8px 0",fontSize:"14px",lineHeight:"1.5"},children:o}),R.code&&t.jsxs("p",{style:{color:"#f5222d",margin:"8px 0 0 0"},children:[t.jsxs("span",{style:{fontWeight:"bold"},children:[e("simulateDebug.parseResult.errorCode"),"："]}),R.code]})]})};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsxs("aside",{className:"side-nav","data-group":"simulate-debug",children:[t.jsx("button",{type:"button",className:`side-item ${i==="parse"?"is-active":""}`,onClick:()=>a("parse"),children:t.jsx("h2",{children:e("simulateDebug.tabs.parse")})}),t.jsx("button",{type:"button",className:`side-item ${i==="convert"?"is-active":""}`,onClick:()=>a("convert"),children:t.jsx("h2",{children:e("simulateDebug.tabs.convert")})})]}),t.jsxs("div",{className:"example-list example-list--compact example-list--spaced",children:[t.jsx("div",{className:"example-list__header",children:t.jsxs("div",{children:[t.jsx("h4",{className:"example-list__title",children:e("simulateDebug.examples.title")}),t.jsx("p",{className:"example-list__desc",children:e("simulateDebug.examples.desc")})]})}),fe?t.jsx("div",{className:"example-list__message",children:e("simulateDebug.examples.loading")}):ee&&ee.length>0?t.jsx("div",{className:"example-list__grid example-list__grid--small",children:ee.map(o=>t.jsx("button",{type:"button",className:`example-list__item ${Ke===o.name?"is-active":""}`,onClick:()=>et(o),children:o.name||e("simulateDebug.examples.unnamed")},o.name||o.key))}):t.jsx("div",{className:"example-list__message",children:e("simulateDebug.examples.noData")})]})]}),t.jsx("section",{className:"page-panels",children:t.jsx("article",{className:"panel is-visible",children:t.jsxs("section",{className:"panel-body simulate-body",children:[i==="parse"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"panel-block",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{children:[t.jsx("h3",{children:e("simulateDebug.logData.title")}),t.jsx("p",{className:"block-desc",children:e("simulateDebug.logData.desc")})]}),t.jsx("div",{className:"block-actions",style:{flexDirection:"column",alignItems:"flex-end",gap:8},children:t.jsxs("div",{style:{display:"flex",gap:8},children:[t.jsx("button",{type:"button",className:"btn ghost",onClick:at,children:e("simulateDebug.logData.base64Decode")}),t.jsx("button",{type:"button",className:"btn ghost",onClick:tt,children:e("simulateDebug.logData.clearAll")})]})})]}),t.jsx(ce,{className:"code-area",language:"json",theme:"vscodeDark",value:s,onChange:o=>n(o)})]}),t.jsxs("div",{className:"split-layout",children:[t.jsx("div",{className:"split-col",children:t.jsxs("div",{className:"panel-block panel-block--fill",children:[t.jsxs("div",{className:"block-header",children:[t.jsx("h3",{children:e("simulateDebug.parseRule.title")}),t.jsxs("div",{className:"block-actions",children:[t.jsx("button",{type:"button",className:"btn ghost",onClick:Xe,children:e("simulateDebug.parseRule.format")}),t.jsx("button",{type:"button",className:"btn primary",onClick:Ze,disabled:k,children:e(k?"simulateDebug.parseRule.parsing":"simulateDebug.parseRule.parse")})]})]}),t.jsx(ce,{className:"code-area code-area--large",language:"wpl",value:c,onChange:o=>p(o)})]})}),t.jsx("div",{className:"split-col",children:t.jsxs("div",{className:"panel-block panel-block--stretch panel-block--scrollable",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("h3",{children:e("simulateDebug.parseResult.title")}),t.jsxs("div",{className:"mode-toggle",children:[t.jsx("button",{type:"button",className:`toggle-btn ${N==="table"?"is-active":""}`,onClick:()=>h("table"),children:e("simulateDebug.parseResult.tableMode")}),t.jsx("button",{type:"button",className:`toggle-btn ${N==="json"?"is-active":""}`,onClick:()=>h("json"),children:e("simulateDebug.parseResult.jsonMode")})]})]}),t.jsxs("label",{className:"switch",children:[t.jsx("input",{type:"checkbox",checked:_,onChange:o=>l(o.target.checked)}),t.jsx("span",{className:"switch-slider"}),t.jsx("span",{className:"switch-label",children:e("simulateDebug.parseResult.showEmpty")})]})]}),t.jsx("div",{className:`mode-content ${N==="table"?"is-active":""}`,children:m?ye():d?t.jsx("div",{style:{paddingBottom:"10px"},children:t.jsx(re,{size:"small",columns:ae,dataSource:I(d.fields,_),pagination:!1,rowKey:"no",className:"data-table compact",scroll:{y:"calc(100vh - 450px)",scrollToFirstRowOnChange:!0}})}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.clickToParse")})}),t.jsx("div",{className:`mode-content ${N==="json"?"is-active":""}`,children:m?ye():d?t.jsx(ne,{className:"code-block",language:"json",style:oe,customStyle:{margin:0,background:"#0f172a"},codeTagProps:{style:{background:"transparent"}},wrapLines:!0,lineProps:{style:{background:"transparent"}},wrapLongLines:!0,children:te(d.formatJson,z(F({},d),{fields:I(d.fields,_)}))}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.clickToParse")})})]})})]})]}),i==="convert"&&t.jsxs("div",{className:"split-layout transform-layout",children:[t.jsx("div",{className:"split-col transform-col",children:t.jsxs("div",{className:"panel-block panel-block--stretch panel-block--fill",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{children:[t.jsx("h3",{children:e("simulateDebug.omlInput.title")}),t.jsx("p",{className:"block-desc",children:e("simulateDebug.omlInput.desc")})]}),t.jsxs("div",{className:"block-actions",children:[t.jsx("button",{type:"button",className:"btn primary",onClick:rt,children:e("simulateDebug.omlInput.format")}),t.jsx("button",{type:"button",className:"btn primary",onClick:st,disabled:k,children:e(k?"simulateDebug.omlInput.converting":"simulateDebug.omlInput.convert")}),t.jsx("button",{type:"button",className:"btn ghost",onClick:()=>$(""),children:e("simulateDebug.omlInput.clear")})]})]}),t.jsx(ce,{className:"code-area code-area--large",language:"oml",value:j,onChange:o=>$(o)})]})}),t.jsxs("div",{className:"split-col transform-col",children:[t.jsxs("div",{className:"panel-block panel-block--scrollable",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("h3",{children:e("simulateDebug.parseResult.title")}),t.jsxs("div",{className:"mode-toggle",children:[t.jsx("button",{type:"button",className:`toggle-btn ${G==="table"?"is-active":""}`,onClick:()=>ue("table"),children:e("simulateDebug.parseResult.tableMode")}),t.jsx("button",{type:"button",className:`toggle-btn ${G==="json"?"is-active":""}`,onClick:()=>ue("json"),children:e("simulateDebug.parseResult.jsonMode")})]})]}),t.jsxs("label",{className:"switch",children:[t.jsx("input",{type:"checkbox",checked:X,onChange:o=>Je(o.target.checked)}),t.jsx("span",{className:"switch-slider"}),t.jsx("span",{className:"switch-label",children:e("simulateDebug.parseResult.showEmpty")})]})]}),t.jsx("div",{className:`mode-content ${G==="table"?"is-active":""}`,children:C?t.jsx("div",{style:{paddingBottom:"10px"},children:t.jsx(re,{size:"small",columns:ae,dataSource:I(se(C.fields,C.formatJson),X),pagination:!1,rowKey:"no",className:"data-table compact",scroll:{y:"calc(50vh - 300px)",scrollToFirstRowOnChange:!0}})}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.willShowHere")})}),t.jsx("div",{className:`mode-content ${G==="json"?"is-active":""}`,children:C?t.jsx(ne,{className:"code-block",language:"json",style:oe,customStyle:{margin:0,background:"#0f172a"},codeTagProps:{style:{background:"transparent"}},wrapLines:!0,lineProps:{style:{background:"transparent"}},wrapLongLines:!0,children:te(C.formatJson,z(F({},C),{fields:I(se(C.fields,C.formatJson),X)}))}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.willShowHere")})})]}),t.jsxs("div",{className:"panel-block panel-block--scrollable",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("h3",{children:e("simulateDebug.convertResult.title")}),t.jsxs("div",{className:"mode-toggle",children:[t.jsx("button",{type:"button",className:`toggle-btn ${V==="table"?"is-active":""}`,onClick:()=>he("table"),children:e("simulateDebug.parseResult.tableMode")}),t.jsx("button",{type:"button",className:`toggle-btn ${V==="json"?"is-active":""}`,onClick:()=>he("json"),children:e("simulateDebug.parseResult.jsonMode")})]})]}),t.jsxs("label",{className:"switch",children:[t.jsx("input",{type:"checkbox",checked:J,onChange:o=>Ve(o.target.checked)}),t.jsx("span",{className:"switch-slider"}),t.jsx("span",{className:"switch-label",children:e("simulateDebug.parseResult.showEmpty")})]})]}),t.jsx("div",{className:`mode-content ${V==="table"?"is-active":""}`,children:R?Te():O?t.jsx("div",{style:{paddingBottom:"10px"},children:t.jsx(re,{size:"small",columns:ae,dataSource:I(O.fields,J),pagination:!1,rowKey:"no",className:"data-table compact",scroll:{y:"calc(50vh - 300px)",scrollToFirstRowOnChange:!0}})}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.convertResult.willShowHere")})}),t.jsx("div",{className:`mode-content ${V==="json"?"is-active":""}`,children:R?Te():O?t.jsx(ne,{className:"code-block",language:"json",style:oe,customStyle:{margin:0,background:"#0f172a"},codeTagProps:{style:{background:"transparent"}},wrapLines:!0,lineProps:{style:{background:"transparent"}},wrapLongLines:!0,children:te(O.formatJson,z(F({},O),{fields:I(O.fields,J)}),o=>J?o:filterEmptyFields(o))}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.convertResult.willShowHere")})})]})]})]})]})})})]})}const Ta=()=>{const[e,i]=x.useState(!1),a="github_star_reminder",s=10*60*1e3;x.useEffect(()=>{const p=localStorage.getItem(a);if(p){const{shown:g}=JSON.parse(p);if(g)return}if(!p){const g={timestamp:Date.now(),shown:!1};localStorage.setItem(a,JSON.stringify(g))}const d=setTimeout(()=>{const g=localStorage.getItem(a);if(g){const{shown:k}=JSON.parse(g);k||i(!0)}},s);return()=>clearTimeout(d)},[]);const n=()=>{i(!1);const p=localStorage.getItem(a);if(p){const d=JSON.parse(p);d.shown=!0,localStorage.setItem(a,JSON.stringify(d))}};return{showReminder:e,closeReminder:n,goToGitHub:()=>{window.open("https://github.com/wp-labs/warp-parse","_blank"),n()}}},ka=({onLocaleChange:e})=>{const{i18n:i}=M(),a=()=>{const n=i.language==="zh-CN"?"en-US":"zh-CN";i.changeLanguage(n),localStorage.setItem("language",n),e(n==="zh-CN"?Ae:de)},s=i.language==="zh-CN"?"EN":"中文";return t.jsx(D,{type:"primary",icon:t.jsx(pt,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:a,children:s})};function wa({versionInfo:e}){const{t:i}=M();return t.jsxs("span",{className:"version-info",style:{fontSize:12,color:"#fff",display:"inline-block",backgroundColor:"rgba(255,255,255,0.1)",padding:"8px 12px",borderRadius:"4px",lineHeight:"1.4"},children:[e.wpEditor&&t.jsxs("span",{style:{display:"block"},children:[i("header.version.wpEditor"),": ",e.wpEditor]}),e.warpEngine||e.warpParse?t.jsxs("span",{style:{display:"block"},children:[e.warpEngine?i("header.version.warpEngine"):i("header.version.warpParse"),":"," ",e.warpEngine||e.warpParse]}):t.jsxs("span",{style:{opacity:.7,display:"block"},children:[i("header.version.warpEngine"),": -"]})]})}function ja({onWechatClick:e,onLocaleChange:i}){const{t:a}=M(),[s,n]=x.useState({wpEditor:"",warpParse:"",warpEngine:""}),c=x.useRef(!1);return x.useEffect(()=>{const p=()=>S(this,null,function*(){try{const d=yield A.get("/version");n({wpEditor:(d==null?void 0:d.wp_editor)||"",warpParse:(d==null?void 0:d.warp_parse)||"",warpEngine:(d==null?void 0:d.warp_engine)||""})}catch(d){}});c.current||(c.current=!0,p())},[]),t.jsxs("header",{className:"main-header",children:[t.jsxs("div",{className:"brand",style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[t.jsx("img",{src:"/assets/images/index.png",alt:"WpEditor",className:"logo",style:{height:"70px"}}),t.jsx("span",{className:"divider",children:"|"}),t.jsx("span",{className:"subtitle",style:{marginRight:10,color:"#fff",fontSize:"20px",fontWeight:"600",paddingLeft:"16px"},children:a("header.editor")})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(D,{type:"primary",icon:t.jsx(dt,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://app.slack.com/client/T0A53FLT4R4/C0A4Q3SC2CF","_blank"),children:a("header.slack")}),t.jsx(D,{type:"primary",icon:t.jsx(mt,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://www.reddit.com/r/warppase/","_blank"),children:a("header.reddit")}),t.jsx(D,{type:"primary",icon:t.jsx(Me,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://github.com/wp-labs/wp-rule/issues","_blank"),children:a("header.github")}),t.jsx(D,{type:"primary",icon:t.jsx("svg",{viewBox:"0 0 36 28",xmlns:"http://www.w3.org/2000/svg",style:{width:"18px",height:"18px",fill:"currentColor"},children:t.jsx("path",{d:"M17.5875 6.77268L21.8232 3.40505L17.5875 0.00748237L17.5837 0L13.3555 3.39757L17.5837 6.76894L17.5875 6.77268ZM17.5863 17.3955H17.59L28.5161 8.77432L25.5526 6.39453L17.59 12.6808H17.5863L17.5825 12.6845L9.61993 6.40201L6.66016 8.78181L17.5825 17.3992L17.5863 17.3955ZM17.5828 23.2891L17.5865 23.2854L32.2133 11.7456L35.1768 14.1254L28.5238 19.3752L17.5865 28L0.284376 14.3574L0 14.1291L2.95977 11.7531L17.5828 23.2891Z"})}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://juejin.cn/user/239030525498106","_blank"),children:a("header.juejin")}),t.jsx(D,{type:"primary",icon:t.jsx(ut,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://wp-labs.github.io/wp-docs/","_blank"),children:a("header.helpCenter")}),t.jsx(D,{type:"primary",icon:t.jsx(ht,{style:{fontSize:"20px"}}),size:"large",shape:"circle",style:{background:"#07C160",borderColor:"#07C160"},onClick:e}),t.jsx(ka,{onLocaleChange:i}),t.jsx(wa,{versionInfo:s})]})]})}function va({open:e,onCancel:i}){const{t:a}=M();return t.jsx(Oe,{title:a("modal.wechat.title"),open:e,onCancel:i,footer:null,centered:!0,width:400,children:t.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[t.jsx("img",{src:"/assets/images/community.png",alt:"微信群二维码",style:{width:"100%",maxWidth:"300px",borderRadius:"8px"}}),t.jsx("div",{style:{marginTop:16,color:"#666",fontSize:14},children:a("modal.wechat.scanTip")})]})})}function Sa({open:e,onCancel:i,onGoToGitHub:a}){const{t:s}=M();return t.jsx(Oe,{title:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(xt,{style:{color:"#faad14",fontSize:"20px"}}),t.jsx("span",{children:s("modal.github.title")})]}),open:e,onCancel:i,footer:[t.jsx(D,{onClick:i,children:s("modal.github.later")},"later"),t.jsx(D,{type:"primary",icon:t.jsx(Me,{}),onClick:a,children:s("modal.github.goToGitHub")},"star")],centered:!0,width:480,children:t.jsxs("div",{style:{padding:"20px 0"},children:[t.jsxs("p",{style:{fontSize:"16px",lineHeight:"1.6",marginBottom:"16px"},children:[s("modal.github.thanks")," ",t.jsx("strong",{children:"WpEditor"}),"！"]}),t.jsx("p",{style:{fontSize:"14px",lineHeight:"1.6",color:"#666"},children:s("modal.github.description")}),t.jsx("p",{style:{fontSize:"14px",lineHeight:"1.6",color:"#666",marginTop:"12px"},children:s("modal.github.support")})]})})}const Na={token:{colorPrimary:"#275efe",colorSuccess:"#17b26a",colorWarning:"#f79009",colorError:"#f1554c",colorInfo:"#12a6e8",colorTextBase:"#1b2533",colorBgBase:"#ffffff",borderRadius:12,fontFamily:'"PingFang SC", "Microsoft YaHei", "Segoe UI", sans-serif'}};function Ca(){const[e,i]=x.useState(!1),[a,s]=x.useState(de),{showReminder:n,closeReminder:c,goToGitHub:p}=Ta();return x.useEffect(()=>{const d=localStorage.getItem("language")||"en-US";s(d==="zh-CN"?Ae:de)},[]),t.jsx(ft,{locale:a,theme:Na,children:t.jsxs("div",{className:"app-shell",children:[t.jsx(ja,{onWechatClick:()=>i(!0),onLocaleChange:s}),t.jsx("div",{className:"app-shell-body",children:t.jsx("div",{className:"main-content",children:t.jsxs(_t,{children:[t.jsx(ie,{path:"/",element:t.jsx(pe,{})}),t.jsx(ie,{path:"/simulate-debug",element:t.jsx(pe,{})}),t.jsx(ie,{path:"*",element:t.jsx(pe,{})})]})})}),t.jsx(va,{open:e,onCancel:()=>i(!1)}),t.jsx(Sa,{open:n,onCancel:c,onGoToGitHub:p})]})})}const Ea={editor:"Editor",slack:"Slack",reddit:"Reddit",github:"GitHub",juejin:"掘金",helpCenter:"帮助中心",version:{wpEditor:"wp-editor",warpEngine:"warp-engine",warpParse:"warp-parse"}},La={wechat:{title:"加入 WarpPase 官方支持交流群",scanTip:"扫描二维码加入微信群"},github:{title:"支持我们的项目",thanks:"感谢您使用",description:"如果您觉得我们的项目对您有帮助，请考虑在 GitHub 上给我们一个 Star ⭐️",support:"您的支持是我们持续改进的动力！",later:"稍后再说",goToGitHub:"前往 GitHub 点赞"}},Da={confirm:"确认",cancel:"取消",save:"保存",delete:"删除",edit:"编辑",close:"关闭",clear:"清空",loading:"加载中...",noData:"暂无数据"},$a={tabs:{parse:"解析",convert:"转换"},examples:{title:"规则示例库",desc:"点击示例，自动填充日志与规则",loading:"示例加载中...",noData:"暂无示例数据",noAvailable:"暂无可用示例，已展示默认示例",fetchError:"获取示例失败",unnamed:"未命名示例"},logData:{title:"日志数据",desc:"粘贴实时采集的原始日志，支持文本与文件导入。",base64Decode:"base64解码",clearAll:"一键清空",base64Error:"Base64解码失败"},parseRule:{title:"解析规则",format:"格式化",parse:"解析",parsing:"解析中...",formatError:"格式化WPL代码失败"},parseResult:{title:"解析结果",tableMode:"表格模式",jsonMode:"JSON 模式",showEmpty:"显示空值",clickToParse:'点击"解析"按钮查看结果',willShowHere:"解析结果将显示在这里",parseFailed:"解析失败",errorCode:"错误码",parseError:"执行解析失败，请稍后重试"},omlInput:{title:"OML 输入",desc:"根据解析结果补齐转换逻辑。",format:"格式化",convert:"转换",converting:"转换中...",clear:"清空",formatError:"格式化OML代码失败",fillOmlWarning:"请先填写 OML 转换规则"},convertResult:{title:"转换结果",willShowHere:"转换结果将显示在这里",convertFailed:"转换失败",convertError:"执行转换失败，请稍后重试"},table:{no:"no",meta:"meta",name:"name",value:"value"}},Ra={header:Ea,modal:La,common:Da,simulateDebug:$a},Pa={editor:"Editor",slack:"Slack",reddit:"Reddit",github:"GitHub",juejin:"Juejin",helpCenter:"Help Center",version:{wpEditor:"wp-editor",warpEngine:"warp-engine",warpParse:"warp-parse"}},Aa={wechat:{title:"Join WarpPase Official Support Group",scanTip:"Scan QR code to join WeChat group"},github:{title:"Support Our Project",thanks:"Thank you for using",description:"If you find our project helpful, please consider giving us a Star on GitHub ⭐️",support:"Your support motivates us to keep improving!",later:"Later",goToGitHub:"Go to GitHub"}},Ma={confirm:"Confirm",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",close:"Close",clear:"Clear",loading:"Loading...",noData:"No Data"},Oa={tabs:{parse:"Parse",convert:"Convert"},examples:{title:"Rule Examples",desc:"Click example to auto-fill logs and rules",loading:"Loading examples...",noData:"No example data",noAvailable:"No examples available, showing default examples",fetchError:"Failed to fetch examples",unnamed:"Unnamed Example"},logData:{title:"Log Data",desc:"Paste raw logs collected in real-time, supports text and file import.",base64Decode:"Base64 Decode",clearAll:"Clear All",base64Error:"Base64 decode failed"},parseRule:{title:"Parse Rule",format:"Format",parse:"Parse",parsing:"Parsing...",formatError:"Failed to format WPL code"},parseResult:{title:"Parse Result",tableMode:"Table Mode",jsonMode:"JSON Mode",showEmpty:"Show Empty",clickToParse:"Click 'Parse' button to view results",willShowHere:"Parse results will be displayed here",parseFailed:"Parse Failed",errorCode:"Error Code",parseError:"Parse execution failed, please try again later"},omlInput:{title:"OML Input",desc:"Complete conversion logic based on parse results.",format:"Format",convert:"Convert",converting:"Converting...",clear:"Clear",formatError:"Failed to format OML code",fillOmlWarning:"Please fill in OML conversion rules first"},convertResult:{title:"Convert Result",willShowHere:"Convert results will be displayed here",convertFailed:"Convert Failed",convertError:"Convert execution failed, please try again later"},table:{no:"no",meta:"meta",name:"name",value:"value"}},Ia={header:Pa,modal:Aa,common:Ma,simulateDebug:Oa},Fa=localStorage.getItem("language")||"en-US";Tt.use(kt).init({resources:{"zh-CN":{translation:Ra},"en-US":{translation:Ia}},lng:Fa,fallbackLng:"en-US",interpolation:{escapeValue:!1}});var Pe;typeof window!="undefined"&&((Pe=window.__REACT_DEVTOOLS_GLOBAL_HOOK__)==null||Pe.inject({renderers:new Map}));zt();const Ge=document.getElementById("root");if(!Ge)throw console.error("未找到 id 为 root 的 DOM 元素，无法挂载应用。"),new Error("Root element not found");gt.createRoot(Ge).render(t.jsx(x.StrictMode,{children:t.jsx(bt,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:t.jsx(Ca,{})})}));
