var et=Object.defineProperty,tt=Object.defineProperties;var st=Object.getOwnPropertyDescriptors;var be=Object.getOwnPropertySymbols;var at=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var ge=(e,i,a)=>i in e?et(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,A=(e,i)=>{for(var a in i||(i={}))at.call(i,a)&&ge(e,a,i[a]);if(be)for(var a of be(i))rt.call(i,a)&&ge(e,a,i[a]);return e},I=(e,i)=>tt(e,st(i));var w=(e,i,a)=>new Promise((s,n)=>{var o=g=>{try{m(a.next(g))}catch(y){n(y)}},d=g=>{try{m(a.throw(g))}catch(y){n(y)}},m=g=>g.done?s(g.value):Promise.resolve(g.value).then(o,d);m((a=a.apply(e,i)).next())});import{r as u,u as R,j as t,F as ee,h as te,o as se,s as $,B as N,R as it,z as $e,e as ne,a as nt,b as lt,c as Re,d as ot,f as ct,M as De,g as pt,C as dt,i as mt,k as ae,l as ut,m as ht,n as xt}from"./vendor-react-BuUa4417.js";import{V as J,_ as Te,p as _t,o as D,i as ft}from"./vendor-utils-y0Sf63-p.js";import{S as Pe,E as M,l as bt,h as gt,a as Tt,b as ye,c as yt,d as kt,k as jt,o as wt,e as vt,f as St,i as Nt,g as Et,j as Ct,m as ke,s as G}from"./vendor-codemirror-CS6EZYFq.js";import"./vendor-antd-CqLsWU86.js";import"./vendor-highlighter-DYEcyQy3.js";import"./vendor-markdown-D9vLozyW.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();const Lt={baseURL:"/api",timeout:1e4,errorConfig:{},interceptors:{request:{onConfig:e=>(e.headers=e.headers||{},e),onError:e=>(console.error("请求拦截器错误:",e),J(e))},response:{onConfig:e=>e,onError:e=>J(e)}}},$t={instanceName:"Gitlab",baseURL:"https://gitlab.com/api/v4",timeout:1e4,errorConfig:{},interceptors:{request:{onConfig:e=>{var i,a;return(a=(i=e.headers)["PRIVATE-TOKEN"])!=null||(i["PRIVATE-TOKEN"]=void 0),e},onError:e=>J(e)},response:{onConfig:e=>e,onError:e=>J(e)}}};function Rt(){Te(Lt),Te($t),_t("Gitlab")}function Dt(e){return w(this,null,function*(){var i,a;try{const s=yield D.post("/debug/decode/base64",e||"",{headers:{"Content-Type":"text/plain;charset=utf-8"},transformRequest:[o=>o]}),n=s&&typeof s=="object"&&"data"in s?s.data:s;if(n&&n.success===!1){const o=((i=n.error)==null?void 0:i.message)||"Base64解码失败，请稍后重试",d=new Error(o);throw d.code=(a=n.error)==null?void 0:a.code,d.responseData=n,d}return n||{}}catch(s){throw s instanceof Error?s:new Error(typeof s=="string"?s:"Base64解码失败，请稍后重试")}})}function Pt(e){return w(this,null,function*(){var i,a;try{const s=yield D.post("/debug/wpl/format",e||"",{headers:{"Content-Type":"text/plain;charset=utf-8"},transformRequest:[o=>o]}),n=s&&typeof s=="object"&&"data"in s?s.data:s;if(n&&n.success===!1){const o=((i=n.error)==null?void 0:i.message)||"格式化 WPL 代码失败，请稍后重试",d=new Error(o);throw d.code=(a=n.error)==null?void 0:a.code,d.responseData=n,d}return typeof n=="string"?{wpl_code:n}:n||{}}catch(s){throw s instanceof Error?s:new Error(typeof s=="string"?s:"格式化WPL代码失败，请稍后重试")}})}function Ot(e){return w(this,null,function*(){var i,a;try{const s=yield D.post("/debug/oml/format",e||"",{headers:{"Content-Type":"text/plain;charset=utf-8"},transformRequest:[o=>o]}),n=s&&typeof s=="object"&&"data"in s?s.data:s;if(n&&n.success===!1){const o=((i=n.error)==null?void 0:i.message)||"格式化 OML 代码失败，请稍后重试",d=new Error(o);throw d.code=(a=n.error)==null?void 0:a.code,d.responseData=n,d}return typeof n=="string"?{oml_code:n}:n||{}}catch(s){throw s instanceof Error?s:new Error(typeof s=="string"?s:"格式化WPL代码失败，请稍后重试")}})}function At(){return w(this,null,function*(){var e,i;try{const a=yield D.get("/debug/examples"),s=a&&typeof a=="object"&&"data"in a?a.data:a;if(s&&s.success===!1){const n=((e=s.error)==null?void 0:e.message)||"获取示例失败，请稍后重试",o=new Error(n);throw o.code=(i=s.error)==null?void 0:i.code,o.responseData=s,o}return s||{}}catch(a){throw a instanceof Error?a:new Error(typeof a=="string"?a:"获取示例失败，请稍后重试")}})}const z=e=>{if(e==null)return"";if(typeof e!="object")return String(e);if(Array.isArray(e))return e.map(o=>z(o)).filter(o=>o!==""&&o!==null&&o!==void 0).join(", ");if(Array.isArray(e.Array)){const n=e.Array.map(o=>{if(o&&typeof o=="object"){if("value"in o)return z(o.value);if("Array"in o)return z(o)}return""}).filter(o=>o!==""&&o!==null&&o!==void 0);return n.length>0?`[${n.join(", ")}]`:""}const i=Object.keys(e);if(i.length===0)return"";const a=i[0],s=e[a];return s==null?"":typeof s=="object"?z(s):String(s)},It=e=>Array.isArray(e)?e.map((i,a)=>{let s=i.meta;return i.meta&&typeof i.meta=="object"&&(i.meta.array?s=`array:${i.meta.array}`:s=JSON.stringify(i.meta)),I(A({},i),{no:a+1,meta:s,value:z(i==null?void 0:i.value)})}):[];function je(e){return w(this,null,function*(){var o,d,m,g,y,k,v,p,h;const{logs:i,rules:a,connectionId:s}=e,n=l=>{const c=(l==null?void 0:l.message)||"执行解析失败，请稍后重试",_=new Error(c);return l!=null&&l.code&&(_.code=l.code),l!=null&&l.details&&(_.details=l.details),l!=null&&l.responseData&&(_.responseData=l.responseData),_};try{const l=yield D.post("/debug/parse",{connection_id:s,rules:a,logs:i}),c=l&&typeof l=="object"&&"data"in l?l.data:l;if(c&&c.success===!1)throw n({message:(o=c.error)==null?void 0:o.message,code:(d=c.error)==null?void 0:d.code,details:((m=c.error)==null?void 0:m.details)||c.error,responseData:c});const _=c;let S=[];return Array.isArray(_==null?void 0:_.fields)?S=_.fields:_!=null&&_.fields&&Array.isArray((g=_==null?void 0:_.fields)==null?void 0:g.items)&&(S=_.fields.items),{fields:It(S),rawFields:S,formatJson:typeof(_==null?void 0:_.format_json)=="string"?_.format_json:""}}catch(l){const c=((y=l==null?void 0:l.response)==null?void 0:y.data)||(l==null?void 0:l.data);throw c&&c.success===!1?n({message:((k=c.error)==null?void 0:k.message)||(l==null?void 0:l.message),code:(v=c.error)==null?void 0:v.code,details:((p=c.error)==null?void 0:p.details)||c.error,responseData:c}):l instanceof Error?(c&&!l.responseData&&(l.responseData=c),!l.details&&(c!=null&&c.error)&&(l.details=c.error),!l.code&&((h=c==null?void 0:c.error)!=null&&h.code)&&(l.code=c.error.code),l):n({message:typeof l=="string"?l:"执行解析失败，请稍后重试",responseData:c})}})}function Ft(e){return w(this,null,function*(){var o,d,m,g,y,k,v;const{oml:i,connectionId:a,parseResult:s}=e;console.log("convertRecord",{oml:i,connectionId:a,parseResult:s});const n=p=>{const h=(p==null?void 0:p.message)||"执行转换失败，请稍后重试",l=new Error(h);return p!=null&&p.code&&(l.code=p.code),p!=null&&p.responseData&&(l.responseData=p.responseData),l};try{const p=yield D.post("/debug/transform",{connection_id:a,parse_result:s||{},oml:i}),h=p&&typeof p=="object"&&"data"in p?p.data:p;if(h&&h.success===!1)throw n({message:(o=h.error)==null?void 0:o.message,code:(d=h.error)==null?void 0:d.code,responseData:h});const l=h;let c=[];return Array.isArray(l==null?void 0:l.fields)?c=l.fields:l!=null&&l.fields&&Array.isArray((m=l==null?void 0:l.fields)==null?void 0:m.items)&&(c=l.fields.items),{fields:c,rawFields:c,formatJson:typeof(l==null?void 0:l.format_json)=="string"?l==null?void 0:l.format_json:""}}catch(p){const h=((g=p==null?void 0:p.response)==null?void 0:g.data)||(p==null?void 0:p.data);throw h&&h.success===!1?n({message:((y=h.error)==null?void 0:y.message)||(p==null?void 0:p.message),code:(k=h.error)==null?void 0:k.code,responseData:h}):p instanceof Error?(h&&!p.responseData&&(p.responseData=h),!p.code&&((v=h==null?void 0:h.error)!=null&&v.code)&&(p.code=h.error.code),p):n({message:typeof p=="string"?p:"执行转换失败，请稍后重试",responseData:h})}})}const Mt="_editor_7ret8_1",zt="_code_7ret8_12",we={editor:Mt,code:zt},Ut=[{label:"chars()",description:"直接创建常量值",example:"chars(13)",insertText:"chars(${chars})"},{label:"digit()",description:"直接创建常量值",example:"digit(13)",insertText:"digit(${digit})"},{label:"read",description:"简单取值",example:"read(simple_chars)",insertText:"read(${Variable})"},{label:"read(keys)",description:"通配符批量操作",example:"a_name_fields = read(keys:[A*/name])",insertText:"a_name_fields = read(${keys:[A*/name]})"},{label:"read",description:"字段不存在时使用默认值",example:"read(optional_field) { _ : chars(DEFAULT_VALUE) }",insertText:"read(${field}) { _ : chars(DEFAULT) }"},{label:"option:[]",description:"选择取值（按顺序尝试多个字段）",example:"read(option:[select_one, select_two])",insertText:"option:[${select_one}]"},{label:"take",description:"破坏性读取并移除源字段",example:"field_taken = take(source_field)",insertText:"take(${source_field})"},{label:"take",description:"take失败使用默认值",example:"field_taken_again = take(source_field) { _ : chars(already_taken) }",insertText:"take(${source_field}) { _ : chars(DEFAULT) }"},{label:"take()",description:"取所有字段",example:"all_fields = take()",insertText:"all_fields = take()"},{label:"take(keys)",description:"通配符批量操作",example:"path_fields = take(keys:[*/path])",insertText:"path_fields = take(keys:[*/path])"},{label:"Now::time()",description:"获取当前完整时间",example:"current_time = Now::time()",insertText:"current_time = Now::time()"},{label:"Now::date()",description:"获取当前日期",example:"current_date = Now::date()",insertText:"Now::date()"},{label:"Now::hour()",description:"获取当前小时",example:"current_hour = Now::hour()",insertText:"Now::hour()"},{label:"match",description:"范围判断",example:"num_range = match read(option:[num_range]) { in (digit(0), digit(1000)) => read(num_range) }",insertText:"match read(option:[${num_range}]) { in (digit(0), digit(1000)) => read(num_range) }"},{label:"match",description:"字段匹配",example:"is_enabled : digit = match read(field) { bool(true) => digit(1) }",insertText:`match read(\${field}) {
  _ => chars(defaule) 
}`},{label:"match",description:"双字段组合匹配",example:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }",insertText:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }"},{label:"match + !",description:"否定条件匹配",example:"valid_status = match read(status) { !chars(error) => chars(ok) }",insertText:"match read(status) { !chars(!{error}) => chars(ok) }"},{label:"Time::to_ts_zone",description:"时间转换（时区）",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"Time::to_ts_zone(${0}, ms)"},{label:"Time::to_ts",description:"时间转换（秒级）",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"Time::to_ts"},{label:"Time::to_ts_ms",description:"时间转换（毫秒）",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"Time::to_ts_ms"},{label:"Time::to_ts_us",description:"时间转换（微秒）",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"Time::to_ts_us"},{label:"base64_decode",description:"Base64 解码",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"base64_decode(${Utf8})"},{label:"base64_encode",description:"Base64 编码",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"base64_encode"},{label:"html_escape",description:"HTML 转义",example:"html_escaped = pipe read(html) | html_escape",insertText:"html_escape"},{label:"html_unescape",description:"HTML 反转义",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"html_unescape"},{label:"json_escape",description:"JSON 转义",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"json_escape"},{label:"json_unescape",description:"JSON 反转义",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"json_unescape"},{label:"str_escape",description:"字符串转义",example:"str_escaped = pipe read(str) | str_escape",insertText:"str_escape"},{label:"to_str",description:"转为字符串",example:"to_str_result = pipe read(str) | to_str",insertText:"to_str"},{label:"to_json",description:"转为 JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"to_json"},{label:"ip4_to_int",description:"IPv4 转整数",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"ip4_to_int"},{label:"nth",description:"数组取元素",example:"array_first = pipe read(array_str) | nth(0)",insertText:"nth(${0})"},{label:"get",description:"对象嵌套取值",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"get(${one/two})"},{label:"path(name)",description:"提取文件名",example:"file_name = pipe read(path) | path(name)",insertText:"path(name)"},{label:"path(path)",description:"提取文件路径",example:"file_path = pipe read(path) | path(path)",insertText:"path(path)"},{label:"url(domain)",description:"提取 URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"url(domain)"},{label:"url(host)",description:"提取 URL host",example:"url_host = pipe read(url) | url(host)",insertText:"url(host)"},{label:"url(uri)",description:"提取 URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"url(uri)"},{label:"url(path)",description:"提取 URL path",example:"url_path = pipe read(url) | url(path)",insertText:"url(path)"},{label:"url(params)",description:"提取 URL params",example:"url_params = pipe read(url) | url(params)",insertText:"url(params)"},{label:"skip_empty",description:"跳过空值",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"skip_empty"},{label:"pipe",description:"流处理",example:"pipe simple_transform = read(data) | to_json",insertText:"pipe"},{label:"fmt",description:"字符串格式化",example:'splice = fmt("{one}:{two}|{three}:{four}", read(one), read(two), read(three), read(four))',insertText:"fmt"},{label:"object",description:"对象创建",example:"extends = object { extend1, extend2 = read() }",insertText:"object { }"},{label:"collect",description:"数组收集",example:"collected_ports : array = collect read(keys:[sport, dport, extra_port])",insertText:"collect read(keys:[${sport}])"},{label:"collect + 通配符",description:"通配符收集",example:"wildcard_items : array = collect take(keys:[details[*]/process_name])",insertText:"collect take(keys:[${details[*]/process_name}])"},{label:"|",description:"时间转换（时区）",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"| Time::to_ts_zone(${0}, ms)"},{label:"|",description:"时间转换（秒级）",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"| Time::to_ts"},{label:"|",description:"时间转换（毫秒）",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"| Time::to_ts_ms"},{label:"|",description:"时间转换（微秒）",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"| Time::to_ts_us"},{label:"|",description:"Base64 解码",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"| base64_decode(${Utf8})"},{label:"|",description:"Base64 编码",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"| base64_encode"},{label:"|",description:"HTML 转义",example:"html_escaped = pipe read(html) | html_escape",insertText:"| html_escape"},{label:"|",description:"HTML 反转义",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"| html_unescape"},{label:"|",description:"JSON 转义",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"| json_escape"},{label:"|",description:"JSON 反转义",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"| json_unescape"},{label:"|",description:"字符串转义",example:"str_escaped = pipe read(str) | str_escape",insertText:"| str_escape"},{label:"|",description:"转为字符串",example:"to_str_result = pipe read(str) | to_str",insertText:"| to_str"},{label:"|",description:"转为 JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"| to_json"},{label:"|",description:"IPv4 转整数",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"| ip4_to_int"},{label:"|",description:"数组取元素",example:"array_first = pipe read(array_str) | nth(0)",insertText:"| nth(${0})"},{label:"|",description:"对象嵌套取值",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"| get(${one/two})"},{label:"|",description:"提取文件名",example:"file_name = pipe read(path) | path(name)",insertText:"| path(name)"},{label:"|",description:"提取文件路径",example:"file_path = pipe read(path) | path(path)",insertText:"| path(path)"},{label:"|",description:"提取 URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"| url(domain)"},{label:"|",description:"提取 URL host",example:"url_host = pipe read(url) | url(host)",insertText:"| url(host)"},{label:"|",description:"提取 URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"| url(uri)"},{label:"|",description:"提取 URL path",example:"url_path = pipe read(url) | url(path)",insertText:"| url(path)"},{label:"|",description:"提取 URL params",example:"url_params = pipe read(url) | url(params)",insertText:"| url(params)"},{label:"|",description:"跳过空值",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"| skip_empty"},{label:"|",description:"流处理",example:"pipe simple_transform = read(data) | to_json",insertText:"| pipe"}],Ht=[{label:"chars()",description:"Create constant value",example:"chars(13)",insertText:"chars(${chars})"},{label:"digit()",description:"Create constant value",example:"digit(13)",insertText:"digit(${digit})"},{label:"read",description:"Simple read",example:"read(simple_chars)",insertText:"read(${Variable})"},{label:"read(keys)",description:"Wildcard batch operation",example:"a_name_fields = read(keys:[A*/name])",insertText:"read(${keys:[A*/name]})"},{label:"read",description:"Use default when field missing",example:"read(optional_field) { _ : chars(DEFAULT_VALUE) }",insertText:"read(${field}) { _ : chars(DEFAULT) }"},{label:"option:[]",description:"Select values in order",example:"read(option:[select_one, select_two])",insertText:"option:[${select_one}]"},{label:"take",description:"Destructive read and remove source field",example:"field_taken = take(source_field)",insertText:"take(${source_field})"},{label:"take",description:"Use default when take fails",example:"field_taken_again = take(source_field) { _ : chars(already_taken) }",insertText:"take(${source_field}) { _ : chars(DEFAULT) }"},{label:"take()",description:"Take all fields",example:"all_fields = take()",insertText:"all_fields = take()"},{label:"take(keys)",description:"Wildcard batch operation",example:"path_fields = take(keys:[*/path])",insertText:"path_fields = take(keys:[*/path])"},{label:"Now::time()",description:"Get current full time",example:"current_time = Now::time()",insertText:"current_time = Now::time()"},{label:"Now::date()",description:"Get current date",example:"current_date = Now::date()",insertText:"Now::date()"},{label:"Now::hour()",description:"Get current hour",example:"current_hour = Now::hour()",insertText:"Now::hour()"},{label:"match",description:"Range match",example:"num_range = match read(option:[num_range]) { in (digit(0), digit(1000)) => read(num_range) }",insertText:"match read(option:[${num_range}]) { in (digit(0), digit(1000)) => read(num_range) }"},{label:"match",description:"Field match",example:"is_enabled : digit = match read(enabled) { bool(true) => digit(1) }",insertText:`match read(\${field}) {
  _ => chars(default)
}`},{label:"match",description:"Two-field tuple match",example:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }",insertText:"location : chars = match (read(city1), read(city2)) { (chars(beijing), chars(shanghai)) => chars(east_region) }"},{label:"match + !",description:"Negation match",example:"valid_status = match read(status) { !chars(error) => chars(ok) }",insertText:"match read(status) { !chars(!{error}) => chars(ok) }"},{label:"Time::to_ts_zone",description:"Time conversion (timezone)",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"Time::to_ts_zone(${0}, ms)"},{label:"Time::to_ts",description:"Time conversion (seconds)",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"Time::to_ts"},{label:"Time::to_ts_ms",description:"Time conversion (milliseconds)",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"Time::to_ts_ms"},{label:"Time::to_ts_us",description:"Time conversion (microseconds)",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"Time::to_ts_us"},{label:"base64_decode",description:"Base64 decode",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"base64_decode(${Utf8})"},{label:"base64_encode",description:"Base64 encode",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"base64_encode"},{label:"html_escape",description:"HTML escape",example:"html_escaped = pipe read(html) | html_escape",insertText:"html_escape"},{label:"html_unescape",description:"HTML unescape",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"html_unescape"},{label:"json_escape",description:"JSON escape",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"json_escape"},{label:"json_unescape",description:"JSON unescape",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"json_unescape"},{label:"str_escape",description:"String escape",example:"str_escaped = pipe read(str) | str_escape",insertText:"str_escape"},{label:"to_str",description:"Convert to string",example:"to_str_result = pipe read(str) | to_str",insertText:"to_str"},{label:"to_json",description:"Convert to JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"to_json"},{label:"ip4_to_int",description:"IPv4 to integer",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"ip4_to_int"},{label:"nth",description:"Get array element",example:"array_first = pipe read(array_str) | nth(0)",insertText:"nth(${0})"},{label:"get",description:"Get nested object value",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"get(${one/two})"},{label:"path(name)",description:"Extract filename",example:"file_name = pipe read(path) | path(name)",insertText:"path(name)"},{label:"path(path)",description:"Extract file path",example:"file_path = pipe read(path) | path(path)",insertText:"path(path)"},{label:"url(domain)",description:"Extract URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"url(domain)"},{label:"url(host)",description:"Extract URL host",example:"url_host = pipe read(url) | url(host)",insertText:"url(host)"},{label:"url(uri)",description:"Extract URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"url(uri)"},{label:"url(path)",description:"Extract URL path",example:"url_path = pipe read(url) | url(path)",insertText:"url(path)"},{label:"url(params)",description:"Extract URL params",example:"url_params = pipe read(url) | url(params)",insertText:"url(params)"},{label:"skip_empty",description:"Skip empty values",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"skip_empty"},{label:"pipe",description:"Stream processing",example:"pipe simple_transform = read(data) | to_json",insertText:"pipe"},{label:"fmt",description:"String format",example:'splice = fmt("{one}:{two}|{three}:{four}", read(one), read(two), read(three), read(four))',insertText:"fmt"},{label:"object",description:"Create object",example:"extends = object { extend1, extend2 = read() }",insertText:"object { }"},{label:"collect",description:"Collect array",example:"collected_ports : array = collect read(keys:[sport, dport, extra_port])",insertText:"collect read(keys:[${sport}])"},{label:"collect + 通配符",description:"Collect with wildcard",example:"wildcard_items : array = collect take(keys:[details[*]/process_name])",insertText:"collect take(keys:[${details[*]/process_name}])"},{label:"|",description:"Time conversion (timezone)",example:"timestamp_zone = pipe read(timestamp_zone) | Time::to_ts_zone(0, ms)",insertText:"| Time::to_ts_zone(${0}, ms)"},{label:"|",description:"Time conversion (seconds)",example:"timestamp_s = pipe read(timestamp_zone) | Time::to_ts",insertText:"| Time::to_ts"},{label:"|",description:"Time conversion (milliseconds)",example:"timestamp_ms = pipe @current_time | Time::to_ts_ms",insertText:"| Time::to_ts_ms"},{label:"|",description:"Time conversion (microseconds)",example:"timestamp_us = pipe @current_time | Time::to_ts_us",insertText:"| Time::to_ts_us"},{label:"|",description:"Base64 decode",example:"base64_decoded = pipe read(base64) | base64_decode(Utf8)",insertText:"| base64_decode(${Utf8})"},{label:"|",description:"Base64 encode",example:"base64_encoded = pipe read(base64) | base64_encode",insertText:"| base64_encode"},{label:"|",description:"HTML escape",example:"html_escaped = pipe read(html) | html_escape",insertText:"| html_escape"},{label:"|",description:"HTML unescape",example:"html_unescaped = pipe read(html) | html_unescape",insertText:"| html_unescape"},{label:"|",description:"JSON escape",example:"json_escaped = pipe read(json_escape) | json_escape",insertText:"| json_escape"},{label:"|",description:"JSON unescape",example:"json_unescaped = pipe @json_escaped | json_unescape",insertText:"| json_unescape"},{label:"|",description:"String escape",example:"str_escaped = pipe read(str) | str_escape",insertText:"| str_escape"},{label:"|",description:"Convert to string",example:"to_str_result = pipe read(str) | to_str",insertText:"| to_str"},{label:"|",description:"Convert to JSON",example:"array_json = pipe read(array_str) | to_json",insertText:"| to_json"},{label:"|",description:"IPv4 to integer",example:"ip_to_int = pipe read(simple_ip) | ip4_to_int",insertText:"| ip4_to_int"},{label:"|",description:"Get array element",example:"array_first = pipe read(array_str) | nth(0)",insertText:"| nth(${0})"},{label:"|",description:"Get nested object value",example:"obj_nested = pipe read(obj) | nth(0) | get(one/two)",insertText:"| get(${one/two})"},{label:"|",description:"Extract filename",example:"file_name = pipe read(path) | path(name)",insertText:"| path(name)"},{label:"|",description:"Extract file path",example:"file_path = pipe read(path) | path(path)",insertText:"| path(path)"},{label:"|",description:"Extract URL domain",example:"url_domain = pipe read(url) | url(domain)",insertText:"| url(domain)"},{label:"|",description:"Extract URL host",example:"url_host = pipe read(url) | url(host)",insertText:"| url(host)"},{label:"|",description:"Extract URL uri",example:"url_uri = pipe read(url) | url(uri)",insertText:"| url(uri)"},{label:"|",description:"Extract URL path",example:"url_path = pipe read(url) | url(path)",insertText:"| url(path)"},{label:"|",description:"Extract URL params",example:"url_params = pipe read(url) | url(params)",insertText:"| url(params)"},{label:"|",description:"Skip empty values",example:"skip_empty_result = pipe read(empty_chars) | skip_empty",insertText:"| skip_empty"},{label:"|",description:"Stream processing",example:"pipe simple_transform = read(data) | to_json",insertText:"| pipe"}],le=[{label:"peek_symbol",kind:"type",description:"预读匹配但不消费输入",example:"peek_symbol(peek_symbol)",insertText:"peek_symbol(${peek_symbol})"},{label:"symbol",kind:"type",description:"精确匹配指定字符串",example:"symbol(symbol)",insertText:"symbol(${symbol})"},{label:"bool",kind:"type",description:"布尔值，匹配 true/false",example:"true",insertText:"bool"},{label:"chars",kind:"type",description:"字符串，支持引号或裸字符串",example:'"hello" / hello',insertText:"chars"},{label:"digit",kind:"type",description:"整数",example:"123 / -456",insertText:"digit"},{label:"float",kind:"type",description:"浮点数",example:"3.14 / -0.5",insertText:"float"},{label:"time",kind:"type",description:"RFC3339/ISO 8601 时间",example:"2026-01-19T12:34:56Z / 2022-03-21T12:34:56+00:00",insertText:"time"},{label:"time_3339",kind:"type",description:"RFC3339/ISO 8601 时间",example:"2026-01-19T12:34:56Z / 2022-03-21T12:34:56+00:00",insertText:"time_3339"},{label:"time_2822",kind:"type",description:"RFC2822 邮件时间格式",example:"Mon, 07 Jul 2025 09:20:32 +0000",insertText:"time_2822"},{label:"time/clf",kind:"type",description:"Common Log Format 时间",example:"[06/Aug/2019:12:12:19 +0800]",insertText:"time/clf"},{label:"time_timestamp",kind:"type",description:"Unix 秒级时间戳",example:"1647849600",insertText:"time_timestamp"},{label:"ip",kind:"type",description:"IPv4/IPv6 地址",example:"192.168.1.100 / ::1",insertText:"ip"},{label:"ip_net",kind:"type",description:"CIDR 网段",example:"192.168.0.0/24",insertText:"ip_net"},{label:"port",kind:"type",description:"端口号（1-65535）",example:"8080",insertText:"port"},{label:"kvarr",kind:"type",description:"键值对 key=value",example:'key="value"',insertText:"kvarr(${chars@name})"},{label:"json",kind:"type",description:"JSON 对象",example:'{"strict":true}',insertText:"json(${chars@field})"},{label:"http/request",kind:"type",description:"HTTP 请求行",example:'"GET /api/users HTTP/1.1"',insertText:"http/request"},{label:"http/status",kind:"type",description:"HTTP 状态码",example:"200",insertText:"http/status"},{label:"http/agent",kind:"type",description:"User-Agent",example:'"Mozilla/5.0"',insertText:"http/agent"},{label:"http/method",kind:"type",description:"HTTP 方法",example:'"POST"',insertText:"http/method"},{label:"hex",kind:"type",description:"十六进制字符串",example:"0x1A2B / 1A2B",insertText:"hex"},{label:"base64",kind:"type",description:"Base64 编码字符串",example:"YmFzZTY0ZGF0YQ==",insertText:"base64"},{label:"sn",kind:"type",description:"字母数字序列号",example:"ABC123XYZ",insertText:"sn"},{label:"_",kind:"type",description:"忽略该字段",example:"忽略该字段",insertText:"_"},{label:"decode/base64",kind:"function",description:"对整行 Base64 解码",example:"aGVsbG8=",insertText:"decode/base64"},{label:"decode/hex",kind:"function",description:"对整行十六进制解码",example:"hello",insertText:"decode/hex"},{label:"unquote/unescape",kind:"function",description:"移除引号并还原转义",example:'"FW\\|action=DROP\\n\\tmsg"',insertText:"unquote/unescape"},{label:"plg_pipe",kind:"function",description:"自定义预处理扩展",example:"|plg_pipe/dayu|",insertText:"plg_pipe/${name}"},{label:"take",kind:"function",description:"选择指定字段为活跃字段",example:"|take(name)|",insertText:"take(${name})"},{label:"last",kind:"function",description:"选择最后一个字段为活跃字段",example:"|last()|",insertText:"last()"},{label:"f_has",kind:"function",description:"检查字段是否存在",example:"|f_has(status)|",insertText:"f_has(${name})"},{label:"f_chars_has",kind:"function",description:"检查字段值等于字符串",example:"|f_chars_has(status, success)|",insertText:"f_chars_has(${name}, ${val})"},{label:"f_chars_not_has",kind:"function",description:"检查字段值不等于字符串",example:"|f_chars_not_has(level, error)|",insertText:"f_chars_not_has(${name}, ${val})"},{label:"f_chars_in",kind:"function",description:"检查字段值在字符串列表",example:"|f_chars_in(method, [GET, POST])|",insertText:"f_chars_in(${name}, [...])"},{label:"f_digit_has",kind:"function",description:"检查字段值等于数字",example:"|f_digit_has(code, 200)|",insertText:"f_digit_has(${name}, ${num})"},{label:"f_digit_in",kind:"function",description:"检查字段值在数字列表",example:"|f_digit_in(status, [200, 201])|",insertText:"f_digit_in(${name}, [...])"},{label:"f_ip_in",kind:"function",description:"检查 IP 在列表",example:"|f_ip_in(client_ip, [127.0.0.1])|",insertText:"f_ip_in(${name}, [...])"},{label:"has",kind:"function",description:"检查活跃字段存在",example:"|take(name)| has()|",insertText:"has()"},{label:"chars_has",kind:"function",description:"检查活跃字段等于字符串",example:"|take(status)| chars_has(success)|",insertText:"chars_has(${val})"},{label:"chars_not_has",kind:"function",description:"检查活跃字段不等于字符串",example:"|take(level)| chars_not_has(error)|",insertText:"chars_not_has(${val})"},{label:"chars_in",kind:"function",description:"检查活跃字段在字符串列表",example:"|take(method)| chars_in([GET, POST])|",insertText:"chars_in([${...}])"},{label:"digit_has",kind:"function",description:"检查活跃字段等于数字",example:"|take(code)| digit_has(200)|",insertText:"digit_has(${num})"},{label:"ip_in",kind:"function",description:"检查活跃 IP 在列表",example:"|take(client_ip)| ip_in([127.0.0.1])|",insertText:"ip_in([${...}])"},{label:"json_unescape",kind:"function",description:"JSON 反转义",example:"|take(message)| json_unescape()|",insertText:"json_unescape()"},{label:"base64_decode",kind:"function",description:"Base64 解码",example:"|take(payload)| base64_decode()|",insertText:"base64_decode()"},{label:"|",kind:"function",description:"自定义预处理扩展",example:"|plg_pipe/dayu|",insertText:"| plg_pipe/${name}"},{label:"|",kind:"function",description:"选择指定字段为活跃字段",example:"|take(name)|",insertText:"| take(${name})"},{label:"|",kind:"function",description:"选择最后一个字段为活跃字段",example:"|last()|",insertText:"| last()"},{label:"|",kind:"function",description:"检查字段是否存在",example:"|f_has(status)|",insertText:"| f_has(${name})"},{label:"|",kind:"function",description:"检查字段值等于字符串",example:"|f_chars_has(status, success)|",insertText:"| f_chars_has(${name}, ${val})"},{label:"|",kind:"function",description:"检查字段值不等于字符串",example:"|f_chars_not_has(level, error)|",insertText:"| f_chars_not_has(${name}, ${val})"},{label:"|",kind:"function",description:"检查字段值在字符串列表",example:"|f_chars_in(method, [GET, POST])|",insertText:"| f_chars_in(${name}, [...])"},{label:"|",kind:"function",description:"检查字段值等于数字",example:"|f_digit_has(code, 200)|",insertText:"| f_digit_has(${name}, ${num})"},{label:"|",kind:"function",description:"检查字段值在数字列表",example:"|f_digit_in(status, [200, 201])|",insertText:"| f_digit_in(${name}, [...])"},{label:"|",kind:"function",description:"检查 IP 在列表",example:"|f_ip_in(client_ip, [127.0.0.1])|",insertText:"| f_ip_in(${name}, [...])"},{label:"|",kind:"function",description:"检查活跃字段存在",example:"|take(name)| has()|",insertText:"| has()"},{label:"|",kind:"function",description:"检查活跃字段等于字符串",example:"|take(status)| chars_has(success)|",insertText:"| chars_has(${val})"},{label:"|",kind:"function",description:"检查活跃字段不等于字符串",example:"|take(level)| chars_not_has(error)|",insertText:"| chars_not_has(${val})"},{label:"|",kind:"function",description:"检查活跃字段在字符串列表",example:"|take(method)| chars_in([GET, POST])|",insertText:"| chars_in([${...}])"},{label:"|",kind:"function",description:"检查活跃字段等于数字",example:"|take(code)| digit_has(200)|",insertText:"| digit_has(${num})"},{label:"|",kind:"function",description:"检查活跃 IP 在列表",example:"|take(client_ip)| ip_in([127.0.0.1])|",insertText:"| ip_in([${...}])"},{label:"|",kind:"function",description:"JSON 反转义",example:"|take(message)| json_unescape()|",insertText:"| json_unescape()"},{label:"|",kind:"function",description:"Base64 解码",example:"|take(payload)| base64_decode()|",insertText:"| base64_decode()"}],Wt=[{label:"peek_symbol",kind:"type",description:"Preview match without consuming input",example:"peek_symbol(peek_symbol)",insertText:"peek_symbol(${peek_symbol})"},{label:"symbol",kind:"type",description:"Exact match for specified string",example:"symbol(symbol)",insertText:"symbol(${symbol})"},{label:"bool",kind:"type",description:"Boolean value, matches true/false",example:"true",insertText:"bool"},{label:"chars",kind:"type",description:"String, quoted or bare",example:'"hello" / hello',insertText:"chars"},{label:"digit",kind:"type",description:"Integer",example:"123 / -456",insertText:"digit"},{label:"float",kind:"type",description:"Float",example:"3.14 / -0.5",insertText:"float"},{label:"time_3339",kind:"type",description:"RFC3339/ISO 8601 time",example:"2026-01-19T12:34:56Z / 2022-03-21T12:34:56+00:00",insertText:"time_3339"},{label:"time_2822",kind:"type",description:"RFC2822 email time format",example:"Mon, 07 Jul 2025 09:20:32 +0000",insertText:"time_2822"},{label:"time/clf",kind:"type",description:"Common Log Format time",example:"[06/Aug/2019:12:12:19 +0800]",insertText:"time/clf"},{label:"time_timestamp",kind:"type",description:"Unix seconds timestamp",example:"1647849600",insertText:"time_timestamp"},{label:"ip",kind:"type",description:"IPv4/IPv6 address",example:"192.168.1.100 / ::1",insertText:"ip"},{label:"ip_net",kind:"type",description:"CIDR network",example:"192.168.0.0/24",insertText:"ip_net"},{label:"port",kind:"type",description:"Port number (1-65535)",example:"8080",insertText:"port"},{label:"kvarr",kind:"type",description:"Key-value pair key=value",example:'key="value"',insertText:"kvarr(${chars@name})"},{label:"json",kind:"type",description:"JSON object",example:'{"strict":true}',insertText:"json(${chars@field})"},{label:"http/request",kind:"type",description:"HTTP request line",example:'"GET /api/users HTTP/1.1"',insertText:"http/request"},{label:"http/status",kind:"type",description:"HTTP status code",example:"200",insertText:"http/status"},{label:"http/agent",kind:"type",description:"User-Agent",example:'"Mozilla/5.0"',insertText:"http/agent"},{label:"http/method",kind:"type",description:"HTTP method",example:'"POST"',insertText:"http/method"},{label:"hex",kind:"type",description:"Hex string",example:"0x1A2B / 1A2B",insertText:"hex"},{label:"base64",kind:"type",description:"Base64 string",example:"YmFzZTY0ZGF0YQ==",insertText:"base64"},{label:"sn",kind:"type",description:"Alphanumeric serial number",example:"ABC123XYZ",insertText:"sn"},{label:"_",kind:"type",description:"Ignore this field",example:"Ignore this field",insertText:"_"},{label:"decode/base64",kind:"function",description:"Base64 decode whole line",example:"aGVsbG8=",insertText:"decode/base64"},{label:"decode/hex",kind:"function",description:"Hex decode whole line",example:"hello",insertText:"decode/hex"},{label:"unquote/unescape",kind:"function",description:"Remove quotes and unescape",example:'"FW\\|action=DROP\\n\\tmsg"',insertText:"unquote/unescape"},{label:"plg_pipe",kind:"function",description:"Custom preprocessor extension",example:"|plg_pipe/dayu|",insertText:"plg_pipe/${name}"},{label:"take",kind:"function",description:"Select specified field as active",example:"|take(name)|",insertText:"take(${name})"},{label:"last",kind:"function",description:"Select last field as active",example:"|last()|",insertText:"last()"},{label:"f_has",kind:"function",description:"Check field exists",example:"|f_has(status)|",insertText:"f_has(${name})"},{label:"f_chars_has",kind:"function",description:"Check field equals string",example:"|f_chars_has(status, success)|",insertText:"f_chars_has(${name}, ${val})"},{label:"f_chars_not_has",kind:"function",description:"Check field not equal string",example:"|f_chars_not_has(level, error)|",insertText:"f_chars_not_has(${name}, ${val})"},{label:"f_chars_in",kind:"function",description:"Check field in string list",example:"|f_chars_in(method, [GET, POST])|",insertText:"f_chars_in(${name}, [...])"},{label:"f_digit_has",kind:"function",description:"Check field equals number",example:"|f_digit_has(code, 200)|",insertText:"f_digit_has(${name}, ${num})"},{label:"f_digit_in",kind:"function",description:"Check field in number list",example:"|f_digit_in(status, [200, 201])|",insertText:"f_digit_in(${name}, [...])"},{label:"f_ip_in",kind:"function",description:"Check IP in list",example:"|f_ip_in(client_ip, [127.0.0.1])|",insertText:"f_ip_in(${name}, [...])"},{label:"has",kind:"function",description:"Check active field exists",example:"|take(name)| has()|",insertText:"has()"},{label:"chars_has",kind:"function",description:"Check active field equals string",example:"|take(status)| chars_has(success)|",insertText:"chars_has(${val})"},{label:"chars_not_has",kind:"function",description:"Check active field not equal string",example:"|take(level)| chars_not_has(error)|",insertText:"chars_not_has(${val})"},{label:"chars_in",kind:"function",description:"Check active field in string list",example:"|take(method)| chars_in([GET, POST])|",insertText:"chars_in([${...}])"},{label:"digit_has",kind:"function",description:"Check active field equals number",example:"|take(code)| digit_has(200)|",insertText:"digit_has(${num})"},{label:"ip_in",kind:"function",description:"Check active IP in list",example:"|take(client_ip)| ip_in([127.0.0.1])|",insertText:"ip_in([${...}])"},{label:"json_unescape",kind:"function",description:"JSON unescape",example:"|take(message)| json_unescape()|",insertText:"json_unescape()"},{label:"base64_decode",kind:"function",description:"Base64 decode",example:"|take(payload)| base64_decode()|",insertText:"base64_decode()"}],Oe={wpl:{keywords:["package","rule","plg_pipe","alt","opt","some_of","seq","order","tag","copy_raw","include","macro"],constants:[]},oml:{keywords:[],types:[],functions:["chars","digit","read","option","take","Now::time","Now::date","Now::hour","match","Time::to_ts_zone","Time::to_ts","Time::to_ts_ms","Time::to_ts_us","base64_decode","base64_encode","html_escape","html_unescape","json_escape","json_unescape","str_escape","to_str","to_json","ip4_to_int","nth","get","path","url","skip_empty","pipe","fmt","object","collect"]}},ve={"zh-CN":{description:"说明",example:"示例",packageDetail:"包定义",packageInfo:"定义 WPL 包路径与作用域。",ruleDetail:"规则定义",ruleInfo:"定义规则名称与规则体。"},"en-US":{description:"Description",example:"Example",packageDetail:"Package",packageInfo:"Define WPL package path and scope.",ruleDetail:"Rule",ruleInfo:"Define rule name and body."}},Ae=e=>ve[e]||ve["zh-CN"],Ie=(e,i,a)=>{const s=[];return i&&s.push(`${e.description}：${i}`),a&&s.push(`${e.example}：${a}`),s.length?s.join(`
`):void 0},Fe=e=>e.description,Bt=e=>{const i=Ae(e),a=e==="en-US"?Wt:le;return[G(["package /${path}/ {","}"].join(`
`),{label:"package",type:"keyword",detail:i.packageDetail,info:i.packageInfo}),G(["rule ${name} {(",")}"].join(`
`),{label:"rule",type:"keyword",detail:i.ruleDetail,info:i.ruleInfo}),...a.map(s=>{const n=Fe(s);return G(s.insertText,{label:s.label,type:s.kind,detail:n,info:Ie(i,n,s.example)})})]},Gt=e=>{const i=Ae(e);return(e==="en-US"?Ht:Ut).map(s=>{const n=Fe(s);return G(s.insertText,{label:s.label,type:"function",detail:n,info:Ie(i,n,s.example)})})},Se=(e,i)=>a=>{var d,m;const s=a.matchBefore(i),n=a.matchBefore(/\|/);return!s&&!n&&!a.explicit?null:{from:(m=(d=n||s)==null?void 0:d.from)!=null?m:a.pos,options:e,validFor:i}},Me=Oe.wpl,Jt=new Set(Me.keywords),Vt=new Set(le.filter(e=>e.kind==="type").map(e=>e.label)),qt=new Set(le.filter(e=>e.kind==="function").map(e=>e.label)),Kt=new Set(Me.constants),Yt=Pe.define({token(e){if(e.eatSpace())return null;if(e.peek()==='"'){for(e.next();!e.eol()&&!(e.next()==='"'&&!e.match(/\\$/,!1)););return"string"}if(e.match(/-?\d+(\.\d+)?/))return"number";if(e.match(/[\w/]+/)){const a=e.current();return Jt.has(a)?"keyword":Vt.has(a)?"typeName":qt.has(a)||a.startsWith("plg_pipe/")?"function":Kt.has(a)?"atom":"variableName"}return e.match(/[{}()[\],|:]/)?"operator":(e.next(),null)}}),Zt=/[\w/]+|\|/,oe=Oe.oml,Ne=new Set(oe.keywords),Ee=new Set(oe.types),Ce=new Set(oe.functions),Qt=/[\w/:\[\]]+|\|/,Xt=Pe.define({token(e){if(e.eatSpace())return null;if(e.peek()==='"'){for(e.next();!e.eol()&&!(e.next()==='"'&&!e.match(/\\$/,!1)););return"string"}if(e.match(/-?\d+(\.\d+)?/))return"number";if(e.match(/[\w/:]+/)){const a=e.current(),s=a.replace(/:+$/,"");return Ne.has(a)||Ne.has(s)?"keyword":Ee.has(a)||Ee.has(s)?"typeName":Ce.has(a)||Ce.has(s)?"function":"variableName"}return e.match(/[{}()[\],|:]/)?"operator":(e.next(),null)}}),es=M.theme({"&":{height:"100%",backgroundColor:"#0f172a",color:"#e2e8f0"},".cm-content":{fontFamily:'"Fira Code", SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',fontSize:"13px",lineHeight:"1.6",padding:"14px 16px"},".cm-scroller":{overflow:"auto"},".cm-gutters":{backgroundColor:"#0b1224",color:"#94a3b8",borderRight:"1px solid rgba(226, 232, 240, 0.1)",minWidth:"48px"},".cm-lineNumbers .cm-gutterElement":{padding:"0 12px 0 10px",textAlign:"right"},".cm-activeLineGutter":{backgroundColor:"rgba(148, 163, 184, 0.1)"},".cm-activeLine":{backgroundColor:"rgba(148, 163, 184, 0.08)"},".cm-content .cm-keyword":{color:"#3b82f6 !important"},".cm-content .ͼp":{color:"#80F4FF !important"},".cm-typeName":{color:"#FFF2b3"},".cm-content .ͼu":{color:"#FFF2b3 !important"},".cm-function":{color:"#7281f4ff"},".cm-atom":{color:"#a5b4fcff"},".cm-string":{color:"#86efac"},".cm-number":{color:"#fde047"},".cm-operator":{color:"#cbd5f5"},".cm-variableName":{color:"#e2e8f0"}}),re=u.forwardRef((e,i)=>{const a=u.useRef(null),s=u.useRef(null),n=e.language||"plain",o=e.textColor,{i18n:d}=R(),m=d.language,g=u.useMemo(()=>Bt(m),[m]),y=u.useMemo(()=>Gt(m),[m]),k=u.useMemo(()=>Se(g,Zt),[g]),v=u.useMemo(()=>Se(y,Qt),[y]),p=u.useMemo(()=>o?M.theme({"&":{color:o},".cm-content":{color:o}}):null,[o]);return u.useImperativeHandle(i,()=>({getValue:()=>{var h;return((h=s.current)==null?void 0:h.state.doc.toString())||""},setValue:h=>{const l=s.current;if(!l)return;const c=h||"",_=l.state.doc.toString();_!==c&&l.dispatch({changes:{from:0,to:_.length,insert:c}})}})),u.useEffect(()=>{if(!a.current)return;const h=M.updateListener.of(S=>{var E;S.docChanged&&((E=e.onChange)==null||E.call(e,S.state.doc.toString()))}),l=[bt(),gt(),Tt(),M.lineWrapping,ye.tabSize.of(2),yt(),kt(),jt.of([...vt,...St,Nt,...Et,...Ct]),wt,es,...p?[p]:[],h];n==="wpl"&&l.splice(6,0,Yt,ke({override:[k]})),n==="oml"&&l.splice(6,0,Xt,ke({override:[v]}));const c=ye.create({doc:e.value||"",extensions:l}),_=new M({state:c,parent:a.current});return s.current=_,()=>{_.destroy(),s.current=null}},[n,m,k,v,p]),u.useEffect(()=>{const h=s.current;if(!h||e.value===void 0)return;const l=e.value||"",c=h.state.doc.toString();c!==l&&h.dispatch({changes:{from:0,to:c.length,insert:l}})},[e.value]),t.jsx("div",{className:`${we.editor} ${e.className||""}`,children:t.jsx("div",{ref:a,className:we.code})})}),ts=[{name:"nginx",wpl_code:`package /nginx/ {
    rule nginx {
        (
            ip:sip,_^2,chars:timestamp<[,]>,http/request",chars:status,chars:size,chars:referer",http/agent",_"
        )
    }
}
`,oml_code:"",sample_data:'180.57.30.148 - - [21/Jan/2025:01:40:02 +0800] "GET /nginx-logo.png HTTP/1.1" 500 368 "<http://207.131.38.110/>" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36" "-"'}];function ie(){const{t:e}=R(),[i,a]=u.useState("parse"),[s,n]=u.useState(""),[o,d]=u.useState(""),[m,g]=u.useState(null),[y,k]=u.useState(!1),[v,p]=u.useState("table"),[h,l]=u.useState(!0),[c,_]=u.useState(null),[S,E]=u.useState(""),[C,V]=u.useState(null),[P,q]=u.useState(null),[U,ce]=u.useState("table"),[H,pe]=u.useState("table"),[W,Ue]=u.useState(!0),[K,He]=u.useState(!0),[L,B]=u.useState(null),[Y,We]=u.useState(ts),[Be,de]=u.useState(null),[me,ue]=u.useState(!1),[he,Ge]=u.useState(!1),xe=u.useRef(!1),Z=(r,x,f)=>{if(r)try{const T=JSON.parse(r),b=f?f(T):T;return JSON.stringify(b,null,2)}catch(T){return r}return JSON.stringify(x,null,2)},Je=()=>w(this,null,function*(){k(!0),_(null);try{const r=yield je({logs:s,rules:o});g(r),r!=null&&r.fields&&(r!=null&&r.rawFields)&&(console.log("转换页解析结果:",r.rawFields),V({fields:r.rawFields,formatJson:r.formatJson}))}catch(r){_(r)}finally{k(!1)}}),Ve=()=>w(this,null,function*(){if(!(me||he||xe.current)){xe.current=!0,ue(!0);try{const r=yield At(),x=r&&typeof r=="object"?Object.values(r):[];Array.isArray(x)&&x.length>0?(We(x),Ge(!0)):!he&&(!x||x.length===0)&&$.info(e("simulateDebug.examples.noAvailable"))}catch(r){$.error(`${e("simulateDebug.examples.fetchError")}：${(r==null?void 0:r.message)||r}`)}finally{ue(!1)}}}),qe=()=>w(this,null,function*(){try{const r=yield Pt(o);console.log("格式化WPL代码响应:",r),d((r==null?void 0:r.wpl_code)||"")}catch(r){$.error(`${e("simulateDebug.parseRule.formatError")}：${(r==null?void 0:r.message)||r}`)}});u.useEffect(()=>{Ve()},[]);const Ke=r=>w(this,null,function*(){if(!r)return;const{sample_data:x,wpl_code:f,oml_code:T}=r;if(n(x||""),d(f||""),E(T||""),de(r.name),!(!x||!f)){k(!0),_(null);try{const b=yield je({logs:x,rules:f});g(b),b!=null&&b.fields&&(b!=null&&b.rawFields)&&V({fields:b.rawFields,formatJson:b.formatJson})}catch(b){_(b)}finally{k(!1)}}}),Ye=()=>{n(""),d(""),g(null),_(null),E(""),V(null),q(null),B(null),de(null)},Ze=()=>w(this,null,function*(){try{const r=yield Dt(s);console.log("Base64解码响应:",r),n(r||"")}catch(r){$.error(`${e("simulateDebug.logData.base64Error")}：${(r==null?void 0:r.message)||r}`)}}),Qe=()=>w(this,null,function*(){var r;if(!S){$.warning(e("simulateDebug.omlInput.fillOmlWarning"));return}k(!0),B(null);try{console.log("转换页解析结果:",C);const x=yield Ft({oml:S,parseResult:C});let f=[];Array.isArray(x==null?void 0:x.fields)?f=x.fields:x!=null&&x.fields&&Array.isArray((r=x==null?void 0:x.fields)==null?void 0:r.items)&&(f=x.fields.items);const T=X(f);q({fields:T,formatJson:x.formatJson||"",rawFields:f}),B(null)}catch(x){$.error(`${e("simulateDebug.convertResult.convertError")}：${(x==null?void 0:x.message)||x}`),B(x),q(null)}finally{k(!1)}}),Xe=()=>w(this,null,function*(){try{const r=yield Ot(S);E((r==null?void 0:r.oml_code)||"")}catch(r){$.error(`${e("simulateDebug.omlInput.formatError")}：${(r==null?void 0:r.message)||r}`)}});e("simulateDebug.tabs.parse"),e("simulateDebug.tabs.convert");const Q=[{title:e("simulateDebug.table.no"),dataIndex:"no",key:"no",width:60},{title:e("simulateDebug.table.meta"),dataIndex:"meta",key:"meta",width:120},{title:e("simulateDebug.table.name"),dataIndex:"name",key:"name",width:150},{title:e("simulateDebug.table.value"),dataIndex:"value",key:"value",style:{wordWrap:"break-word",wordBreak:"break-all",maxWidth:300}}],O=(r,x)=>{const f=Array.isArray(r)?r:[];return x?f:f.filter(T=>{if(!T||typeof T!="object")return!1;const b=T.value;return b!==""&&b!==null&&b!==void 0})},F=r=>{if(r==null)return"";if(typeof r!="object")return String(r);if(Array.isArray(r)){const b=r.map(j=>F(j)).filter(j=>j!==""&&j!==null&&j!==void 0);return b.length>0?`[${b.join(", ")}]`:""}if(Array.isArray(r.Array)){const b=r.Array.map(j=>j&&typeof j=="object"&&"value"in j?F(j.value):F(j)).filter(j=>j!==""&&j!==null&&j!==void 0);return b.length>0?`[${b.join(", ")}]`:""}const x=Object.keys(r);if(x.length===0)return"";const f=x[0],T=r[f];return T==null?"":typeof T=="object"?F(T):String(T)},X=r=>(Array.isArray(r)?r:[]).map((f,T)=>{let b=f.meta;return f.meta&&typeof f.meta=="object"&&(f.meta.array?b=`array:${f.meta.array}`:b=JSON.stringify(f.meta)),I(A({},f),{no:T+1,meta:b,value:F(f==null?void 0:f.value)})}),_e=()=>c?t.jsxs("div",{style:{padding:"20px",backgroundColor:"#fff1f0",border:"1px solid #ffccc7",borderRadius:4,margin:"10px"},children:[t.jsx("h4",{style:{color:"#f5222d",marginBottom:"8px",fontWeight:"bold"},children:e("simulateDebug.parseResult.parseFailed")}),t.jsx("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",color:"#666",margin:"0 0 8px 0",fontSize:"14px",lineHeight:"1.5"},children:c.message||e("simulateDebug.parseResult.parseError")}),c.code&&t.jsxs("p",{style:{color:"#f5222d",margin:"8px 0 0 0"},children:[t.jsxs("span",{style:{fontWeight:"bold"},children:[e("simulateDebug.parseResult.errorCode"),"："]}),c.code]})]}):null,fe=()=>{var x,f,T,b;if(!L)return null;const r=L.message||((f=(x=L.responseData)==null?void 0:x.error)==null?void 0:f.message)||((b=(T=L.data)==null?void 0:T.error)==null?void 0:b.message)||e("simulateDebug.convertResult.convertError");return t.jsxs("div",{style:{padding:"20px",backgroundColor:"#fff1f0",border:"1px solid #ffccc7",borderRadius:4,margin:"10px"},children:[t.jsx("h4",{style:{color:"#f5222d",marginBottom:"8px",fontWeight:"bold"},children:e("simulateDebug.convertResult.convertFailed")}),t.jsx("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",color:"#666",margin:"0 0 8px 0",fontSize:"14px",lineHeight:"1.5"},children:r}),L.code&&t.jsxs("p",{style:{color:"#f5222d",margin:"8px 0 0 0"},children:[t.jsxs("span",{style:{fontWeight:"bold"},children:[e("simulateDebug.parseResult.errorCode"),"："]}),L.code]})]})};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsxs("aside",{className:"side-nav","data-group":"simulate-debug",children:[t.jsx("button",{type:"button",className:`side-item ${i==="parse"?"is-active":""}`,onClick:()=>a("parse"),children:t.jsx("h2",{children:e("simulateDebug.tabs.parse")})}),t.jsx("button",{type:"button",className:`side-item ${i==="convert"?"is-active":""}`,onClick:()=>a("convert"),children:t.jsx("h2",{children:e("simulateDebug.tabs.convert")})})]}),t.jsxs("div",{className:"example-list example-list--compact example-list--spaced",children:[t.jsx("div",{className:"example-list__header",children:t.jsxs("div",{children:[t.jsx("h4",{className:"example-list__title",children:e("simulateDebug.examples.title")}),t.jsx("p",{className:"example-list__desc",children:e("simulateDebug.examples.desc")})]})}),me?t.jsx("div",{className:"example-list__message",children:e("simulateDebug.examples.loading")}):Y&&Y.length>0?t.jsx("div",{className:"example-list__grid example-list__grid--small",children:Y.map(r=>t.jsx("button",{type:"button",className:`example-list__item ${Be===r.name?"is-active":""}`,onClick:()=>Ke(r),children:r.name||e("simulateDebug.examples.unnamed")},r.name||r.key))}):t.jsx("div",{className:"example-list__message",children:e("simulateDebug.examples.noData")})]})]}),t.jsx("section",{className:"page-panels",children:t.jsx("article",{className:"panel is-visible",children:t.jsxs("section",{className:"panel-body simulate-body",children:[i==="parse"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"panel-block",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{children:[t.jsx("h3",{children:e("simulateDebug.logData.title")}),t.jsx("p",{className:"block-desc",children:e("simulateDebug.logData.desc")})]}),t.jsx("div",{className:"block-actions",style:{flexDirection:"column",alignItems:"flex-end",gap:8},children:t.jsxs("div",{style:{display:"flex",gap:8},children:[t.jsx("button",{type:"button",className:"btn ghost",onClick:Ze,children:e("simulateDebug.logData.base64Decode")}),t.jsx("button",{type:"button",className:"btn ghost",onClick:Ye,children:e("simulateDebug.logData.clearAll")})]})})]}),t.jsx(re,{className:"code-area",value:s,onChange:r=>n(r),textColor:"#ffffff"})]}),t.jsxs("div",{className:"split-layout",children:[t.jsx("div",{className:"split-col",children:t.jsxs("div",{className:"panel-block panel-block--fill",children:[t.jsxs("div",{className:"block-header",children:[t.jsx("h3",{children:e("simulateDebug.parseRule.title")}),t.jsxs("div",{className:"block-actions",children:[t.jsx("button",{type:"button",className:"btn ghost",onClick:qe,children:e("simulateDebug.parseRule.format")}),t.jsx("button",{type:"button",className:"btn primary",onClick:Je,disabled:y,children:e(y?"simulateDebug.parseRule.parsing":"simulateDebug.parseRule.parse")})]})]}),t.jsx(re,{className:"code-area code-area--large",language:"wpl",value:o,onChange:r=>d(r)})]})}),t.jsx("div",{className:"split-col",children:t.jsxs("div",{className:"panel-block panel-block--stretch panel-block--scrollable",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("h3",{children:e("simulateDebug.parseResult.title")}),t.jsxs("div",{className:"mode-toggle",children:[t.jsx("button",{type:"button",className:`toggle-btn ${v==="table"?"is-active":""}`,onClick:()=>p("table"),children:e("simulateDebug.parseResult.tableMode")}),t.jsx("button",{type:"button",className:`toggle-btn ${v==="json"?"is-active":""}`,onClick:()=>p("json"),children:e("simulateDebug.parseResult.jsonMode")})]})]}),t.jsxs("label",{className:"switch",children:[t.jsx("input",{type:"checkbox",checked:h,onChange:r=>l(r.target.checked)}),t.jsx("span",{className:"switch-slider"}),t.jsx("span",{className:"switch-label",children:e("simulateDebug.parseResult.showEmpty")})]})]}),t.jsx("div",{className:`mode-content ${v==="table"?"is-active":""}`,children:c?_e():m?t.jsx("div",{style:{paddingBottom:"10px"},children:t.jsx(ee,{size:"small",columns:Q,dataSource:O(m.fields,h),pagination:!1,rowKey:"no",className:"data-table compact",scroll:{y:"calc(100vh - 450px)",scrollToFirstRowOnChange:!0}})}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.clickToParse")})}),t.jsx("div",{className:`mode-content ${v==="json"?"is-active":""}`,children:c?_e():m?t.jsx(te,{className:"code-block",language:"json",style:se,customStyle:{margin:0,background:"#0f172a"},codeTagProps:{style:{background:"transparent"}},wrapLines:!0,lineProps:{style:{background:"transparent"}},wrapLongLines:!0,children:Z(m.formatJson,I(A({},m),{fields:O(m.fields,h)}))}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.clickToParse")})})]})})]})]}),i==="convert"&&t.jsxs("div",{className:"split-layout transform-layout",children:[t.jsx("div",{className:"split-col transform-col",children:t.jsxs("div",{className:"panel-block panel-block--stretch panel-block--fill",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{children:[t.jsx("h3",{children:e("simulateDebug.omlInput.title")}),t.jsx("p",{className:"block-desc",children:e("simulateDebug.omlInput.desc")})]}),t.jsxs("div",{className:"block-actions",children:[t.jsx("button",{type:"button",className:"btn primary",onClick:Xe,children:e("simulateDebug.omlInput.format")}),t.jsx("button",{type:"button",className:"btn primary",onClick:Qe,disabled:y,children:e(y?"simulateDebug.omlInput.converting":"simulateDebug.omlInput.convert")}),t.jsx("button",{type:"button",className:"btn ghost",onClick:()=>E(""),children:e("simulateDebug.omlInput.clear")})]})]}),t.jsx(re,{className:"code-area code-area--large",language:"oml",value:S,onChange:r=>E(r)})]})}),t.jsxs("div",{className:"split-col transform-col",children:[t.jsxs("div",{className:"panel-block panel-block--scrollable",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("h3",{children:e("simulateDebug.parseResult.title")}),t.jsxs("div",{className:"mode-toggle",children:[t.jsx("button",{type:"button",className:`toggle-btn ${U==="table"?"is-active":""}`,onClick:()=>ce("table"),children:e("simulateDebug.parseResult.tableMode")}),t.jsx("button",{type:"button",className:`toggle-btn ${U==="json"?"is-active":""}`,onClick:()=>ce("json"),children:e("simulateDebug.parseResult.jsonMode")})]})]}),t.jsxs("label",{className:"switch",children:[t.jsx("input",{type:"checkbox",checked:K,onChange:r=>He(r.target.checked)}),t.jsx("span",{className:"switch-slider"}),t.jsx("span",{className:"switch-label",children:e("simulateDebug.parseResult.showEmpty")})]})]}),t.jsx("div",{className:`mode-content ${U==="table"?"is-active":""}`,children:C?t.jsx("div",{style:{paddingBottom:"10px"},children:t.jsx(ee,{size:"small",columns:Q,dataSource:O(X(C.fields),K),pagination:!1,rowKey:"no",className:"data-table compact",scroll:{y:"calc(50vh - 300px)",scrollToFirstRowOnChange:!0}})}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.willShowHere")})}),t.jsx("div",{className:`mode-content ${U==="json"?"is-active":""}`,children:C?t.jsx(te,{className:"code-block",language:"json",style:se,customStyle:{margin:0,background:"#0f172a"},codeTagProps:{style:{background:"transparent"}},wrapLines:!0,lineProps:{style:{background:"transparent"}},wrapLongLines:!0,children:Z(C.formatJson,I(A({},C),{fields:O(X(C.fields),K)}))}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.parseResult.willShowHere")})})]}),t.jsxs("div",{className:"panel-block panel-block--scrollable",children:[t.jsxs("div",{className:"block-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("h3",{children:e("simulateDebug.convertResult.title")}),t.jsxs("div",{className:"mode-toggle",children:[t.jsx("button",{type:"button",className:`toggle-btn ${H==="table"?"is-active":""}`,onClick:()=>pe("table"),children:e("simulateDebug.parseResult.tableMode")}),t.jsx("button",{type:"button",className:`toggle-btn ${H==="json"?"is-active":""}`,onClick:()=>pe("json"),children:e("simulateDebug.parseResult.jsonMode")})]})]}),t.jsxs("label",{className:"switch",children:[t.jsx("input",{type:"checkbox",checked:W,onChange:r=>Ue(r.target.checked)}),t.jsx("span",{className:"switch-slider"}),t.jsx("span",{className:"switch-label",children:e("simulateDebug.parseResult.showEmpty")})]})]}),t.jsx("div",{className:`mode-content ${H==="table"?"is-active":""}`,children:L?fe():P?t.jsx("div",{style:{paddingBottom:"10px"},children:t.jsx(ee,{size:"small",columns:Q,dataSource:O(P.fields,W),pagination:!1,rowKey:"no",className:"data-table compact",scroll:{y:"calc(50vh - 300px)",scrollToFirstRowOnChange:!0}})}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.convertResult.willShowHere")})}),t.jsx("div",{className:`mode-content ${H==="json"?"is-active":""}`,children:L?fe():P?t.jsx(te,{className:"code-block",language:"json",style:se,customStyle:{margin:0,background:"#0f172a"},codeTagProps:{style:{background:"transparent"}},wrapLines:!0,lineProps:{style:{background:"transparent"}},wrapLongLines:!0,children:Z(P.formatJson,I(A({},P),{fields:O(P.fields,W)}),r=>W?r:filterEmptyFields(r))}):t.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:e("simulateDebug.convertResult.willShowHere")})})]})]})]})]})})})]})}const ss=()=>{const[e,i]=u.useState(!1),a="github_star_reminder",s=10*60*1e3;u.useEffect(()=>{const d=localStorage.getItem(a);if(d){const{shown:g}=JSON.parse(d);if(g)return}if(!d){const g={timestamp:Date.now(),shown:!1};localStorage.setItem(a,JSON.stringify(g))}const m=setTimeout(()=>{const g=localStorage.getItem(a);if(g){const{shown:y}=JSON.parse(g);y||i(!0)}},s);return()=>clearTimeout(m)},[]);const n=()=>{i(!1);const d=localStorage.getItem(a);if(d){const m=JSON.parse(d);m.shown=!0,localStorage.setItem(a,JSON.stringify(m))}};return{showReminder:e,closeReminder:n,goToGitHub:()=>{window.open("https://github.com/wp-labs/warp-parse","_blank"),n()}}},as=({onLocaleChange:e})=>{const{i18n:i}=R(),a=()=>{const n=i.language==="zh-CN"?"en-US":"zh-CN";i.changeLanguage(n),localStorage.setItem("language",n),e(n==="zh-CN"?$e:ne)},s=i.language==="zh-CN"?"EN":"中文";return t.jsx(N,{type:"primary",icon:t.jsx(it,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:a,children:s})};function rs({versionInfo:e}){const{t:i}=R();return t.jsxs("span",{className:"version-info",style:{fontSize:12,color:"#fff",display:"inline-block",backgroundColor:"rgba(255,255,255,0.1)",padding:"8px 12px",borderRadius:"4px",lineHeight:"1.4"},children:[e.wpEditor&&t.jsxs("span",{style:{display:"block"},children:[i("header.version.wpEditor"),": ",e.wpEditor]}),e.warpEngine||e.warpParse?t.jsxs("span",{style:{display:"block"},children:[e.warpEngine?i("header.version.warpEngine"):i("header.version.warpParse"),":"," ",e.warpEngine||e.warpParse]}):t.jsxs("span",{style:{opacity:.7,display:"block"},children:[i("header.version.warpEngine"),": -"]})]})}function is({onWechatClick:e,onLocaleChange:i}){const{t:a}=R(),[s,n]=u.useState({wpEditor:"",warpParse:"",warpEngine:""}),o=u.useRef(!1);return u.useEffect(()=>{const d=()=>w(this,null,function*(){try{const m=yield D.get("/version");n({wpEditor:(m==null?void 0:m.wp_editor)||"",warpParse:(m==null?void 0:m.warp_parse)||"",warpEngine:(m==null?void 0:m.warp_engine)||""})}catch(m){}});o.current||(o.current=!0,d())},[]),t.jsxs("header",{className:"main-header",children:[t.jsxs("div",{className:"brand",style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[t.jsx("img",{src:"/assets/images/index.png",alt:"WpEditor",className:"logo",style:{height:"70px"}}),t.jsx("span",{className:"divider",children:"|"}),t.jsx("span",{className:"subtitle",style:{marginRight:10,color:"#fff",fontSize:"20px",fontWeight:"600",paddingLeft:"16px"},children:a("header.editor")})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(N,{type:"primary",icon:t.jsx(nt,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://app.slack.com/client/T0A53FLT4R4/C0A4Q3SC2CF","_blank"),children:a("header.slack")}),t.jsx(N,{type:"primary",icon:t.jsx(lt,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://www.reddit.com/r/warppase/","_blank"),children:a("header.reddit")}),t.jsx(N,{type:"primary",icon:t.jsx(Re,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://github.com/wp-labs/wp-rule/issues","_blank"),children:a("header.github")}),t.jsx(N,{type:"primary",icon:t.jsx("svg",{viewBox:"0 0 36 28",xmlns:"http://www.w3.org/2000/svg",style:{width:"18px",height:"18px",fill:"currentColor"},children:t.jsx("path",{d:"M17.5875 6.77268L21.8232 3.40505L17.5875 0.00748237L17.5837 0L13.3555 3.39757L17.5837 6.76894L17.5875 6.77268ZM17.5863 17.3955H17.59L28.5161 8.77432L25.5526 6.39453L17.59 12.6808H17.5863L17.5825 12.6845L9.61993 6.40201L6.66016 8.78181L17.5825 17.3992L17.5863 17.3955ZM17.5828 23.2891L17.5865 23.2854L32.2133 11.7456L35.1768 14.1254L28.5238 19.3752L17.5865 28L0.284376 14.3574L0 14.1291L2.95977 11.7531L17.5828 23.2891Z"})}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://juejin.cn/user/239030525498106","_blank"),children:a("header.juejin")}),t.jsx(N,{type:"primary",icon:t.jsx(ot,{style:{fontSize:"18px"}}),size:"large",style:{fontWeight:600,fontSize:"15px"},onClick:()=>window.open("https://wp-labs.github.io/wp-docs/","_blank"),children:a("header.helpCenter")}),t.jsx(N,{type:"primary",icon:t.jsx(ct,{style:{fontSize:"20px"}}),size:"large",shape:"circle",style:{background:"#07C160",borderColor:"#07C160"},onClick:e}),t.jsx(as,{onLocaleChange:i}),t.jsx(rs,{versionInfo:s})]})]})}function ns({open:e,onCancel:i}){const{t:a}=R();return t.jsx(De,{title:a("modal.wechat.title"),open:e,onCancel:i,footer:null,centered:!0,width:400,children:t.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[t.jsx("img",{src:"/assets/images/vx.png",alt:"微信群二维码",style:{width:"100%",maxWidth:"300px",borderRadius:"8px"}}),t.jsx("div",{style:{marginTop:16,color:"#666",fontSize:14},children:a("modal.wechat.scanTip")})]})})}function ls({open:e,onCancel:i,onGoToGitHub:a}){const{t:s}=R();return t.jsx(De,{title:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(pt,{style:{color:"#faad14",fontSize:"20px"}}),t.jsx("span",{children:s("modal.github.title")})]}),open:e,onCancel:i,footer:[t.jsx(N,{onClick:i,children:s("modal.github.later")},"later"),t.jsx(N,{type:"primary",icon:t.jsx(Re,{}),onClick:a,children:s("modal.github.goToGitHub")},"star")],centered:!0,width:480,children:t.jsxs("div",{style:{padding:"20px 0"},children:[t.jsxs("p",{style:{fontSize:"16px",lineHeight:"1.6",marginBottom:"16px"},children:[s("modal.github.thanks")," ",t.jsx("strong",{children:"WpEditor"}),"！"]}),t.jsx("p",{style:{fontSize:"14px",lineHeight:"1.6",color:"#666"},children:s("modal.github.description")}),t.jsx("p",{style:{fontSize:"14px",lineHeight:"1.6",color:"#666",marginTop:"12px"},children:s("modal.github.support")})]})})}const os={token:{colorPrimary:"#275efe",colorSuccess:"#17b26a",colorWarning:"#f79009",colorError:"#f1554c",colorInfo:"#12a6e8",colorTextBase:"#1b2533",colorBgBase:"#ffffff",borderRadius:12,fontFamily:'"PingFang SC", "Microsoft YaHei", "Segoe UI", sans-serif'}};function cs(){const[e,i]=u.useState(!1),[a,s]=u.useState(ne),{showReminder:n,closeReminder:o,goToGitHub:d}=ss();return u.useEffect(()=>{const m=localStorage.getItem("language")||"en-US";s(m==="zh-CN"?$e:ne)},[]),t.jsx(dt,{locale:a,theme:os,children:t.jsxs("div",{className:"app-shell",children:[t.jsx(is,{onWechatClick:()=>i(!0),onLocaleChange:s}),t.jsx("div",{className:"app-shell-body",children:t.jsx("div",{className:"main-content",children:t.jsxs(mt,{children:[t.jsx(ae,{path:"/",element:t.jsx(ie,{})}),t.jsx(ae,{path:"/simulate-debug",element:t.jsx(ie,{})}),t.jsx(ae,{path:"*",element:t.jsx(ie,{})})]})})}),t.jsx(ns,{open:e,onCancel:()=>i(!1)}),t.jsx(ls,{open:n,onCancel:o,onGoToGitHub:d})]})})}const ps={editor:"Editor",slack:"Slack",reddit:"Reddit",github:"GitHub",juejin:"掘金",helpCenter:"帮助中心",version:{wpEditor:"wp-editor",warpEngine:"warp-engine",warpParse:"warp-parse"}},ds={wechat:{title:"加入 WarpPase 官方支持交流群",scanTip:"扫描二维码加入微信群"},github:{title:"支持我们的项目",thanks:"感谢您使用",description:"如果您觉得我们的项目对您有帮助，请考虑在 GitHub 上给我们一个 Star ⭐️",support:"您的支持是我们持续改进的动力！",later:"稍后再说",goToGitHub:"前往 GitHub 点赞"}},ms={confirm:"确认",cancel:"取消",save:"保存",delete:"删除",edit:"编辑",close:"关闭",clear:"清空",loading:"加载中...",noData:"暂无数据"},us={tabs:{parse:"解析",convert:"转换"},examples:{title:"规则示例库",desc:"点击示例，自动填充日志与规则",loading:"示例加载中...",noData:"暂无示例数据",noAvailable:"暂无可用示例，已展示默认示例",fetchError:"获取示例失败",unnamed:"未命名示例"},logData:{title:"日志数据",desc:"粘贴实时采集的原始日志，支持文本与文件导入。",base64Decode:"base64解码",clearAll:"一键清空",base64Error:"Base64解码失败"},parseRule:{title:"解析规则",format:"格式化",parse:"解析",parsing:"解析中...",formatError:"格式化WPL代码失败"},parseResult:{title:"解析结果",tableMode:"表格模式",jsonMode:"JSON 模式",showEmpty:"显示空值",clickToParse:'点击"解析"按钮查看结果',willShowHere:"解析结果将显示在这里",parseFailed:"解析失败",errorCode:"错误码",parseError:"执行解析失败，请稍后重试"},omlInput:{title:"OML 输入",desc:"根据解析结果补齐转换逻辑。",format:"格式化",convert:"转换",converting:"转换中...",clear:"清空",formatError:"格式化OML代码失败",fillOmlWarning:"请先填写 OML 转换规则"},convertResult:{title:"转换结果",willShowHere:"转换结果将显示在这里",convertFailed:"转换失败",convertError:"执行转换失败，请稍后重试"},table:{no:"no",meta:"meta",name:"name",value:"value"}},hs={header:ps,modal:ds,common:ms,simulateDebug:us},xs={editor:"Editor",slack:"Slack",reddit:"Reddit",github:"GitHub",juejin:"Juejin",helpCenter:"Help Center",version:{wpEditor:"wp-editor",warpEngine:"warp-engine",warpParse:"warp-parse"}},_s={wechat:{title:"Join WarpPase Official Support Group",scanTip:"Scan QR code to join WeChat group"},github:{title:"Support Our Project",thanks:"Thank you for using",description:"If you find our project helpful, please consider giving us a Star on GitHub ⭐️",support:"Your support motivates us to keep improving!",later:"Later",goToGitHub:"Go to GitHub"}},fs={confirm:"Confirm",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",close:"Close",clear:"Clear",loading:"Loading...",noData:"No Data"},bs={tabs:{parse:"Parse",convert:"Convert"},examples:{title:"Rule Examples",desc:"Click example to auto-fill logs and rules",loading:"Loading examples...",noData:"No example data",noAvailable:"No examples available, showing default examples",fetchError:"Failed to fetch examples",unnamed:"Unnamed Example"},logData:{title:"Log Data",desc:"Paste raw logs collected in real-time, supports text and file import.",base64Decode:"Base64 Decode",clearAll:"Clear All",base64Error:"Base64 decode failed"},parseRule:{title:"Parse Rule",format:"Format",parse:"Parse",parsing:"Parsing...",formatError:"Failed to format WPL code"},parseResult:{title:"Parse Result",tableMode:"Table Mode",jsonMode:"JSON Mode",showEmpty:"Show Empty",clickToParse:"Click 'Parse' button to view results",willShowHere:"Parse results will be displayed here",parseFailed:"Parse Failed",errorCode:"Error Code",parseError:"Parse execution failed, please try again later"},omlInput:{title:"OML Input",desc:"Complete conversion logic based on parse results.",format:"Format",convert:"Convert",converting:"Converting...",clear:"Clear",formatError:"Failed to format OML code",fillOmlWarning:"Please fill in OML conversion rules first"},convertResult:{title:"Convert Result",willShowHere:"Convert results will be displayed here",convertFailed:"Convert Failed",convertError:"Convert execution failed, please try again later"},table:{no:"no",meta:"meta",name:"name",value:"value"}},gs={header:xs,modal:_s,common:fs,simulateDebug:bs},Ts=localStorage.getItem("language")||"en-US";ft.use(ut).init({resources:{"zh-CN":{translation:hs},"en-US":{translation:gs}},lng:Ts,fallbackLng:"en-US",interpolation:{escapeValue:!1}});var Le;typeof window!="undefined"&&((Le=window.__REACT_DEVTOOLS_GLOBAL_HOOK__)==null||Le.inject({renderers:new Map}));Rt();const ze=document.getElementById("root");if(!ze)throw console.error("未找到 id 为 root 的 DOM 元素，无法挂载应用。"),new Error("Root element not found");ht.createRoot(ze).render(t.jsx(u.StrictMode,{children:t.jsx(xt,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:t.jsx(cs,{})})}));
